<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>godwifi</title>

<link rel="preload" as="image" href="freewifi.png" />
<link rel="icon" type="image/png" href="favicon.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lovers+Quarrel&display=swap" rel="stylesheet">

<style>
  /* ===== Splash Screen (Missing Person Report) ===== */
  .splash-screen{
    position: fixed;
    inset: 0;
    background: #ffffff;
    z-index: 20000;
    display: flex;
    padding: 0;
  }
  
  .splash-screen.hidden{
    display: none;
  }
  
  .splash-left{
    flex: 0.7;
    background-image: url('E16B01A6-6D20-4129-9A8C-1AE54DC0412E.PNG');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }
  
  .splash-right{
    flex: 1.3;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
  }
  
  .splash-content{
    text-align: center;
    max-width: 600px;
  }
  
  .splash-title{
    font-size: clamp(28px, 5vw, 42px);
    font-weight: 700;
    color: #1a1a1a;
    margin-bottom: 20px;
    line-height: 1.3;
  }
  
  .splash-subtitle{
    font-size: clamp(16px, 3vw, 20px);
    color: #666;
    margin-bottom: 40px;
    line-height: 1.6;
  }
  
  .splash-button{
    padding: 18px 48px;
    font-size: 18px;
    font-weight: 600;
    background: #2563eb;
    color: white;
    border: 0;
    border-radius: 12px;
    cursor: pointer;
    transition: .2s ease;
    box-shadow: 0 4px 12px rgba(37,99,235,.3);
  }
  
  .splash-button:hover{
    background: #1d4ed8;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(37,99,235,.4);
  }
  
  /* ===== Mobile & Tablet Responsiveness ===== */
  @media (max-width: 1200px) {
    .app{
      width: 95vw !important;
      max-width: 95vw !important;
    }
    
    .taskbar{
      font-size: 12px;
    }
    
    .taskbar-app{
      min-width: 100px;
      max-width: 140px;
      padding: 0 8px;
      font-size: 11px;
    }
  }
  
  @media (max-width: 768px) {
    /* Splash screen mobile */
    .splash-screen{
      flex-direction: column;
    }
    
    .splash-left{
      flex: 1;
      min-height: 50vh;
    }
    
    .splash-right{
      flex: 1;
      padding: 30px 20px;
    }
    
    .splash-title{
      font-size: 24px;
    }
    
    .splash-subtitle{
      font-size: 16px;
      margin-bottom: 30px;
    }
    
    /* Desktop icons */
    .icons{
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
      gap: 16px;
      padding: 12px;
    }
    
    .icon{
      width: 70px;
      font-size: 11px;
    }
    
    .icon .pic{
      width: 48px;
      height: 48px;
    }
    
    /* Windows */
    .app{
      width: 100vw !important;
      height: 100vh !important;
      max-width: 100vw !important;
      max-height: calc(100vh - 56px) !important;
      border-radius: 0 !important;
      top: 0 !important;
      left: 0 !important;
    }
    
    .app.open{
      transform: none !important;
    }
    
    .titlebar{
      padding: 8px 12px;
    }
    
    .title{
      font-size: 14px;
    }
    
    .win-btn{
      width: 28px;
      height: 28px;
      font-size: 12px;
    }
    
    /* Taskbar */
    .taskbar{
      height: 56px;
      padding: 6px 8px;
    }
    
    .taskbar-left{
      gap: 6px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    
    .taskbar-left::-webkit-scrollbar{
      display: none;
    }
    
    .start-btn{
      width: 40px;
      height: 32px;
      font-size: 18px;
    }
    
    .taskbar-app{
      min-width: 80px;
      max-width: 120px;
      height: 32px;
      padding: 0 8px;
      font-size: 11px;
      gap: 4px;
    }
    
    .taskbar-icon{
      width: 16px;
      height: 16px;
    }
    
    .taskbar-separator{
      display: none;
    }
    
    .taskbar-social{
      display: none !important;
    }
    
    .taskbar-right{
      gap: 8px;
    }
    
    .system-tray{
      gap: 8px;
    }
    
    .tray-icon{
      padding: 4px 6px;
    }
    
    .battery{
      font-size: 11px;
    }
    
    #clock{
      font-size: 12px;
    }
    
    /* Menu */
    .menuWrap{
      width: 100vw !important;
      height: 100vh !important;
      border-radius: 0 !important;
      top: 0 !important;
      left: 0 !important;
    }
    
    .menu{
      grid-template-columns: 1fr;
      gap: 12px;
      padding: 20px;
    }
    
    /* Player controls */
    .playerBar{
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .ctrl{
      order: 1;
      width: 100%;
      justify-content: center;
    }
    
    .vol{
      order: 2;
      width: 100%;
      justify-content: center;
    }
    
    .now{
      order: 0;
      width: 100%;
      text-align: center;
    }
    
    /* Video player */
    video#videoPlayer{
      max-height: 300px !important;
    }
    
    /* Notes */
    .notesWrap{
      flex-direction: column;
      height: auto !important;
      min-height: 300px;
    }
    
    .notesSidebar{
      width: 100%;
      border-right: 0;
      border-bottom: 1px solid var(--iconBorder);
    }
    
    /* Photos grid */
    .icloudGrid{
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 8px;
      padding: 12px;
    }
    
    /* Game canvas */
    canvas#dinoCanvas{
      height: 180px;
    }
    
    /* SMS notifications */
    .sms-notification,
    .sms-conversation{
      width: calc(100vw - 20px);
      right: 10px;
      bottom: 62px;
    }
    
    /* Login modal */
    .login-modal .login-box{
      width: 90vw;
    }
    
    /* iCloud viewer */
    .icloudViewer{
      padding: 10px;
    }
    
    .icloudViewerTop{
      padding: 12px;
    }
    
    /* Finder grid */
    .finderGrid{
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 12px;
    }
  }
  
  @media (max-width: 480px) {
    .splash-title{
      font-size: 20px;
    }
    
    .splash-subtitle{
      font-size: 14px;
    }
    
    .splash-button{
      padding: 14px 32px;
      font-size: 16px;
    }
    
    .icon{
      width: 60px;
      font-size: 10px;
    }
    
    .icon .pic{
      width: 40px;
      height: 40px;
    }
    
    .mbtn{
      width: 32px;
      height: 32px;
    }
    
    .playBig{
      width: 38px;
      height: 38px;
    }
    
    .icloudGrid{
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    }
  }
  
  /* Touch improvements */
  @media (hover: none) and (pointer: coarse) {
    .mbtn,
    .win-btn,
    .icon,
    .finderItem,
    .track,
    .sms-option,
    .taskbar-app,
    .start-btn{
      -webkit-tap-highlight-color: transparent;
    }
    
    .mbtn:active,
    .win-btn:active{
      transform: scale(0.95);
    }
    
    /* Larger touch targets */
    .win-btn{
      width: 32px;
      height: 32px;
    }
    
    .tray-icon{
      padding: 8px 10px;
    }
  }
  
  /* ===== Blue Screen of Death ===== */
  .bluescreen{
    position: fixed;
    inset: 0;
    background: #0078d7;
    z-index: 19999;
    opacity: 0;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: white;
    font-family: 'Segoe UI', sans-serif;
    padding: 40px;
  }
  
  .bluescreen.active{
    opacity: 1;
    pointer-events: auto;
  }
  
  .bsod-emoji{
    font-size: 120px;
    margin-bottom: 30px;
  }
  
  .bsod-title{
    font-size: 32px;
    font-weight: 400;
    margin-bottom: 20px;
  }
  
  .bsod-text{
    font-size: 18px;
    margin-bottom: 40px;
    opacity: 0.9;
  }
  
  .bsod-error{
    font-size: 14px;
    font-family: 'Consolas', monospace;
    opacity: 0.7;
    margin-bottom: 20px;
  }
  
  .bsod-percentage{
    font-size: 24px;
    margin-top: 20px;
  }
  
  /* ===== Safe Boot Screen ===== */
  .safeboot-screen{
    position: fixed;
    inset: 0;
    background: #000;
    z-index: 19998;
    display: none;
    flex-direction: column;
    padding: 40px;
    color: #aaa;
    font-family: 'Consolas', 'Courier New', monospace;
    font-size: 14px;
    overflow-y: auto;
  }
  
  .safeboot-screen.active{
    display: flex;
  }
  
  .safeboot-line{
    margin: 2px 0;
    opacity: 0;
    animation: fadeInLine 0.1s ease forwards;
  }
  
  @keyframes fadeInLine {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .safeboot-line.ok::after{
    content: " [OK]";
    color: #0f0;
  }
  
  .safeboot-line.failed::after{
    content: " [FAILED]";
    color: #f00;
  }
  
  .safeboot-title{
    color: #fff;
    font-size: 16px;
    font-weight: bold;
    margin: 20px 0 10px 0;
  }
  
  /* ===== System Loading Screen ===== */
  .system-loading{
    position: fixed;
    inset: 0;
    background: #0a0a0a;
    z-index: 19997;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #00ff00;
    font-family: 'Courier New', monospace;
    padding: 20px;
  }
  
  .system-loading.active{
    display: flex;
  }
  
  .system-logo{
    font-size: 48px;
    margin-bottom: 40px;
    animation: pulse 2s ease-in-out infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  .system-text{
    font-size: 16px;
    margin-bottom: 30px;
    text-align: center;
  }
  
  .system-progress{
    width: 300px;
    height: 4px;
    background: #1a1a1a;
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 30px;
  }
  
  .system-progress-bar{
    height: 100%;
    background: #00ff00;
    width: 0%;
    animation: loadProgress 3s ease-in-out forwards;
  }
  
  @keyframes loadProgress {
    0% { width: 0%; }
    100% { width: 100%; }
  }
  
  .system-login-btn{
    padding: 16px 64px;
    font-size: 18px;
    font-weight: 600;
    background: #00ff00;
    color: #0a0a0a;
    border: 2px solid #00ff00;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Courier New', monospace;
    transition: .2s ease;
    opacity: 0;
    animation: fadeInBtn 0.5s ease forwards 3s;
  }
  
  @keyframes fadeInBtn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .system-login-btn:hover{
    background: #0a0a0a;
    color: #00ff00;
    box-shadow: 0 0 20px rgba(0,255,0,.3);
  }

  :root{
    --shadow: 0 20px 60px rgba(0,0,0,.25);
    --border: rgba(0,0,0,.15);
    --text: rgba(0,0,0,.9);
    --muted: rgba(0,0,0,.6);

    --taskbarBg: rgba(240,240,245,.98);
    --taskbarBorder: rgba(0,0,0,.12);

    --windowBg: rgba(250,250,252,.96);
    --windowBorder: rgba(0,0,0,.15);
    
    --titlebarBg: rgba(240,240,245,.98);
    --titlebarBorder: rgba(0,0,0,.1);
    
    --wallpaperBg: #f2f2f2;
    --wallpaperText: rgba(0,0,0,0.15);
    
    --iconBg: rgba(0,0,0,.04);
    --iconBorder: rgba(0,0,0,.08);
    --iconShadow: 0 2px 8px rgba(0,0,0,.08);
    
    --finderBg: rgba(0,0,0,.04);
    --finderHoverBg: rgba(0,0,0,.06);
    
    --canvasBg: rgba(245,245,248,.95);
    --canvasStroke: rgba(0,0,0,.25);
    --canvasPlayer: rgba(0,0,0,.85);
    --canvasObstacle: rgba(0,0,0,.6);
    --canvasCloud: rgba(0,0,0,1);
    
    --wifiIconColor: rgba(0,0,0,.75);
    --batteryBorder: rgba(0,0,0,.3);
  }

  /* Dark theme */
  @media (prefers-color-scheme: dark) {
    :root{
      --shadow: 0 20px 60px rgba(0,0,0,.6);
      --border: rgba(255,255,255,.15);
      --text: rgba(255,255,255,.95);
      --muted: rgba(255,255,255,.75);

      --taskbarBg: rgba(30,30,35,.96);
      --taskbarBorder: rgba(255,255,255,.08);

      --windowBg: rgba(40,40,45,.95);
      --windowBorder: rgba(255,255,255,.15);
      
      --titlebarBg: rgba(50,50,55,.98);
      --titlebarBorder: rgba(255,255,255,.1);
      
      --wallpaperBg: linear-gradient(180deg,#0a0c14,#050507);
      --wallpaperText: rgba(255,255,255,0.15);
      
      --iconBg: rgba(255,255,255,.1);
      --iconBorder: rgba(255,255,255,.15);
      --iconShadow: 0 4px 12px rgba(0,0,0,.3);
      
      --finderBg: rgba(255,255,255,.08);
      --finderHoverBg: rgba(255,255,255,.14);
      
      --canvasBg: rgba(20,20,25,.9);
      --canvasStroke: rgba(255,255,255,.3);
      --canvasPlayer: rgba(255,255,255,.92);
      --canvasObstacle: rgba(255,255,255,.6);
      --canvasCloud: rgba(255,255,255,1);
      
      --wifiIconColor: rgba(255,255,255,.85);
      --batteryBorder: rgba(255,255,255,.4);
    }
    
    body {
      color: var(--text);
    }
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    font-family: "Segoe UI", Ubuntu, "DejaVu Sans", Roboto, Arial, sans-serif;
    overflow:hidden;
    color:var(--text);
    user-select:none;
  }

  /* ===== Wallpaper ===== */
  .wallpaper{
    position:fixed; inset:0;
    background: var(--wallpaperBg);
    display: grid;
    place-items: center;
  }

  .wallpaper::after{
    content: "Macie tu Wifi?...";
    font-size: clamp(36px, 5.5vw, 80px);
    font-weight: 400;
    color: var(--wallpaperText);
    letter-spacing: 1px;
    text-align: center;
    padding: 0 20px;
    font-family: Papyrus, "Papyrus", "Lovers Quarrel", "Brush Script MT", cursive;
    font-style: normal;
  }

  .grain{
    position:fixed; inset:0;
    pointer-events:none;
    opacity:.02;
    background-image:
      radial-gradient(circle at 20% 30%, rgba(0,0,0,.03), transparent 40%);
    mix-blend-mode: overlay;
  }
  
  @media (prefers-color-scheme: dark) {
    .grain{
      opacity:.08;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.06), transparent 40%);
    }
  }

  .brandBlur{
    display: none;
  }

  /* ===== Windows-style Taskbar (bottom) ===== */
  .taskbar{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    height:48px;
    display:flex;
    align-items:center;
    padding:0 8px;
    background: var(--taskbarBg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top:1px solid var(--taskbarBorder);
    z-index:1000;
    box-shadow: 0 -2px 20px rgba(0,0,0,.4);
  }

  .taskbar-left{
    display:flex;
    align-items:center;
    gap:4px;
    flex:1;
  }

  .start-btn{
    width:48px;
    height:36px;
    display:grid;
    place-items:center;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
    border-radius:4px;
    cursor:pointer;
    font-size:20px;
    color: var(--text);
    transition:.15s ease;
  }
  .start-btn:hover{
    background: var(--finderHoverBg);
  }

  .taskbar-app{
    height:36px;
    min-width:160px;
    max-width:200px;
    padding:0 12px;
    display:flex;
    align-items:center;
    gap:8px;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
    border-radius:4px;
    cursor:pointer;
    transition:.15s ease;
    font-size:13px;
    color: var(--text);
  }
  .taskbar-app:hover{
    background: var(--finderHoverBg);
  }
  .taskbar-app.active{
    background: var(--finderHoverBg);
    border-bottom:2px solid rgba(80,150,255,.9);
  }
  
  .taskbar-separator{
    width:1px;
    height:28px;
    background: var(--iconBorder);
    margin:0 4px;
  }
  
  .taskbar-social{
    display:flex !important;
  }

  .taskbar-icon{
    width:20px;
    height:20px;
    object-fit:contain;
  }

  .taskbar-right{
    display:flex;
    align-items:center;
    gap:16px;
    font-size:13px;
  }

  .system-tray{
    display:flex;
    align-items:center;
    gap:12px;
  }

  .tray-icon{
    padding:6px 10px;
    border-radius:4px;
    cursor:pointer;
    transition:.15s ease;
    color: var(--text);
  }
  .tray-icon:hover{
    background: var(--finderHoverBg);
  }
  
  .wifi-icon{
    width:16px;
    height:16px;
    display:inline-block;
    position:relative;
    vertical-align:middle;
  }
  
  .wifi-icon::before,
  .wifi-icon::after{
    content:"";
    position:absolute;
    border:2px solid var(--wifiIconColor);
    border-radius:50%;
  }
  
  /* Outer arc */
  .wifi-icon::before{
    width:14px;
    height:14px;
    top:-2px;
    left:1px;
    border-bottom:none;
    border-left:none;
    border-right:none;
    transform:rotate(-45deg);
  }
  
  /* Inner arc */
  .wifi-icon::after{
    width:9px;
    height:9px;
    top:1px;
    left:3.5px;
    border-bottom:none;
    border-left:none;
    border-right:none;
    transform:rotate(-45deg);
  }
  
  .wifi-dot{
    position:absolute;
    width:3px;
    height:3px;
    background: var(--wifiIconColor);
    border-radius:50%;
    bottom:1px;
    left:50%;
    transform:translateX(-50%);
  }

  .battery{
    display:flex;
    align-items:center;
    gap:6px;
    font-size:12px;
    color: var(--text);
  }
  .batteryIcon{
    width:22px;
    height:11px;
    border-radius:3px;
    border:1.5px solid var(--batteryBorder);
    position:relative;
    overflow:hidden;
    background: var(--finderBg);
  }
  .batteryLevel{
    position:absolute;
    left:0; top:0; bottom:0;
    width:50%;
    background: rgba(60,200,100,.9);
  }
  .batteryCap{
    position:absolute;
    right:-2.5px;
    top:2px;
    width:2.5px;
    height:6px;
    border-radius:2px;
    background: var(--batteryBorder);
  }
  .batteryBolt{
    position:absolute;
    inset:0;
    display:grid;
    place-items:center;
    font-size:9px;
    opacity:0;
    transform: translateY(-0.5px);
    pointer-events:none;
  }

  /* ===== Desktop icons (Ubuntu-style grid) ===== */
  .icons{
    position:fixed;
    top:20px;
    left:20px;
    display:grid;
    gap:20px;
    z-index:10;
  }

  .icon{
    width:80px;
    text-align:center;
    font-size:12px;
    line-height:1.3;
    text-shadow: 0 1px 2px rgba(255,255,255,.8);
    color: var(--text);
    cursor:pointer;
  }
  
  @media (prefers-color-scheme: dark) {
    .icon{
      text-shadow: 0 1px 3px rgba(0,0,0,.8);
    }
  }

  .icon .pic{
    width:56px;
    height:56px;
    margin:0 auto 8px;
    border-radius:8px;
    display:grid;
    place-items:center;
    background: var(--iconBg);
    border:1px solid var(--iconBorder);
    backdrop-filter: blur(8px);
    box-shadow: var(--iconShadow);
    transition:.15s ease;
  }
  .icon:hover .pic{
    transform: scale(1.05);
    background: var(--finderHoverBg);
  }

  .deskIconImg{
    width:65%;
    height:65%;
    object-fit:cover;
    border-radius:6px;
  }

  /* ===== Window system (Windows/Ubuntu hybrid) ===== */
  .stage{
    position:fixed;
    inset:0 0 48px 0;
    z-index:200;
    pointer-events:none;
  }

  .app{
    position:fixed;
    left:50%;
    top:50%;
    width:min(600px, 90vw);
    border-radius:8px 8px 0 0;
    overflow:hidden;
    background: var(--windowBg);
    border:1px solid var(--windowBorder);
    box-shadow: var(--shadow);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);

    opacity:0;
    pointer-events:none;
    transform: translate(-50%,-50%) translate(var(--x,0px), var(--y,0px)) scale(.96);
    transition: transform .18s ease, opacity .15s ease;
  }

  .app.open{
    opacity:1;
    pointer-events:auto;
    transform: translate(-50%,-50%) translate(var(--x,0px), var(--y,0px)) scale(1);
  }

  .app.dragging{
    transition:none !important;
    cursor:move;
  }

  /* Ubuntu-style titlebar */
  .titlebar{
    height:36px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 12px;
    background: var(--titlebarBg);
    border-bottom:1px solid var(--titlebarBorder);
    cursor:move;
  }

  .window-controls{
    display:flex;
    gap:8px;
    align-items:center;
  }
  
  .win-btn{
    width:12px;
    height:12px;
    border-radius:50%;
    border:0;
    padding:0;
    cursor:pointer;
    font-size:9px;
    font-weight:bold;
    display:grid;
    place-items:center;
    transition:.15s ease;
    font-family: system-ui, -apple-system, sans-serif;
    position:relative;
    color: transparent;
  }
  
  .win-btn:hover{
    color: rgba(0,0,0,.7);
  }
  
  .win-btn.close{
    background: #FF5F57;
  }
  .win-btn.close:hover{ 
    background: #FF5F57;
  }
  .win-btn.close::after{
    content: "√ó";
    font-size:14px;
    font-weight:300;
  }
  
  .win-btn.minimize{
    background: #FFBD2E;
  }
  .win-btn.minimize:hover{ 
    background: #FFBD2E;
  }
  .win-btn.minimize::after{
    content: "‚àí";
    font-size:12px;
    font-weight:700;
  }
  
  .win-btn.maximize{
    background: #28CA42;
  }
  .win-btn.maximize:hover{ 
    background: #28CA42;
  }
  .win-btn.maximize::after{
    content: "‚§¢";
    font-size:8px;
  }

  .title{
    font-size:13px;
    font-weight:600;
    color: var(--text);
    letter-spacing:.3px;
  }

  .content{
    padding:32px 24px 24px;
    text-align:center;
    color: var(--text);
  }

  .logoBtn{
    border:0;
    background:transparent;
    padding:0;
    cursor:pointer;
  }
  .logo{
    width:min(300px, 70vw);
    height:auto;
    display:block;
    margin:0 auto;
    filter: drop-shadow(0 12px 28px rgba(0,0,0,.4));
    transition:.2s ease;
  }
  .logoBtn:hover .logo{ transform: scale(1.03); }
  .hint{ margin-top:12px; font-size:13px; color: var(--muted); }

  .menuWrap{
    margin-top:18px;
    overflow:hidden;
    max-height:0;
    opacity:0;
    transform: translateY(-8px);
    transition: all .35s ease;
  }
  .menuWrap.open{
    max-height:400px;
    opacity:1;
    transform: translateY(0);
  }
  .menu{ display:grid; gap:12px; }

  .menu a{
    text-decoration:none;
    color: var(--text);
    border-radius:6px;
    padding:13px 16px;
    font-size:14px;
    font-weight:600;
    text-align:center;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
    box-shadow: 0 1px 4px rgba(0,0,0,.08);
    transition:.15s ease;
  }
  .menu a:hover{
    background: var(--finderHoverBg);
    transform: translateY(-1px);
  }
  .menu a.discord{
    background: rgba(88,101,242,.9);
    border:1px solid rgba(88,101,242,1);
    color: rgba(255,255,255,.98);
  }
  .menu a.discord:hover{ background: rgba(88,101,242,1); }

  /* ===== Finder/File manager ===== */
  .app.finder{ width:min(720px, 92vw); }
  .finderBody{ padding:16px; }
  .finderGrid{
    display:grid;
    grid-template-columns: repeat(4, minmax(100px, 1fr));
    gap:12px;
  }
  .finderItem{
    border:0;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
    border-radius:6px;
    padding:14px 12px;
    color: var(--text);
    display:grid;
    place-items:center;
    gap:8px;
    cursor:pointer;
    transition:.12s ease;
  }
  .finderItem:hover{
    background: var(--finderHoverBg);
    transform: translateY(-2px);
  }
  .finderIcon{
    width:48px;
    height:48px;
    object-fit:cover;
    object-position:center;
  }
  
  /* Notepad icons - make them fill the space */
  .notepad-icon{
    width:48px;
    height:48px;
    object-fit:contain;
    padding:4px;
  }
  
  .finderItem span{ font-size:12px; }
  .finderPath{
    font-size:12px;
    opacity:.7;
    padding:10px 16px;
    background: var(--finderBg);
    border-bottom:1px solid var(--iconBorder);
    color: var(--text);
  }
  .fileBadge{
    font-size:11px;
    opacity:.65;
    margin-top:-4px;
  }

  /* ===== Notes ===== */
  .app.notes{ width: min(820px, 94vw); }
  .notesWrap{
    display:flex;
    min-height:400px;
    height:min(58vh,580px);
    background: var(--windowBg);
  }
  .notesSidebar{
    width:220px;
    border-right:1px solid var(--iconBorder);
    background: var(--finderBg);
    padding:12px;
  }
  .notesSideTitle{
    font-size:12px;
    opacity:.7;
    margin-bottom:8px;
    color: var(--text);
  }
  .notesItem{
    background: var(--finderHoverBg);
    border:1px solid var(--iconBorder);
    border-radius:6px;
    padding:10px;
    color: var(--text);
  }
  .notesEditor{
    flex:1;
    padding:16px;
    color: var(--text);
  }
  .notePaper{
    background: var(--finderBg);
    border-radius:6px;
    padding:16px;
    border:1px solid var(--iconBorder);
    color: var(--text);
  }

  /* ===== Game ===== */
  .app.game{ width: min(780px, 96vw); }
  .gameWrap{ padding:16px; text-align:left; }
  .gameTop{
    display:flex;
    justify-content:space-between;
    margin-bottom:10px;
    font-size:13px;
    color: var(--text);
  }
  canvas#dinoCanvas{
    width:100%;
    height:220px;
    border-radius:6px;
    border:1px solid var(--border);
    background: var(--canvasBg);
    box-shadow: 0 4px 16px rgba(0,0,0,.1);
  }
  .gameHint{ margin-top:10px; font-size:12px; opacity:.7; color: var(--muted); }

  /* ===== Player ===== */
  .player{ padding:16px; text-align:left; }
  .playerBar{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    padding:10px 12px;
    border-radius:6px;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
  }
  .now{ min-width:0; }
  .now .title{
    font-size:13px;
    font-weight:700;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    color: var(--text);
  }
  .now .meta{ font-size:12px; opacity:.7; margin-top:2px; color: var(--muted); }
  .ctrl{ display:flex; gap:8px; }
  .mbtn{
    width:36px; 
    height:36px;
    border-radius:8px;
    border:1px solid var(--border);
    background: var(--finderBg);
    color: var(--text);
    cursor:pointer;
    display:grid;
    place-items:center;
    transition:.12s ease;
    font-size:0;
    position:relative;
  }
  
  /* Modern SVG-like icons using CSS */
  .mbtn::before{
    content:"";
    display:block;
  }
  
  /* Shuffle icon */
  .mbtn#mixShuffle::before{
    content:"‚§®";
    font-size:16px;
  }
  
  /* Previous icon */
  .mbtn#mixPrev::before{
    width:0;
    height:0;
    border-style:solid;
    border-width:6px 10px 6px 0;
    border-color:transparent var(--text) transparent transparent;
    margin-right:2px;
  }
  
  /* Play/Pause icon - will be controlled by JS */
  .mbtn#mixPlay::before{
    width:0;
    height:0;
    border-style:solid;
    border-width:7px 0 7px 12px;
    border-color:transparent transparent transparent var(--text);
    margin-left:2px;
  }
  
  .mbtn#mixPlay.playing::before{
    width:10px;
    height:14px;
    border:0;
    border-left:3px solid var(--text);
    border-right:3px solid var(--text);
    background:transparent;
    margin-left:0;
  }
  
  /* Next icon */
  .mbtn#mixNext::before{
    width:0;
    height:0;
    border-style:solid;
    border-width:6px 0 6px 10px;
    border-color:transparent transparent transparent var(--text);
    margin-left:2px;
  }
  
  /* Repeat icon */
  .mbtn#mixRepeat::before{
    content:"‚Üª";
    font-size:18px;
  }
  
  .mbtn:hover{ 
    background: var(--finderHoverBg); 
    transform:translateY(-1px);
  }
  .mbtn.on{ 
    background: rgba(80,150,255,.6); 
    color: rgba(255,255,255,.95); 
  }
  .mbtn.on::before{
    border-color:transparent transparent transparent rgba(255,255,255,.95);
  }
  .mbtn.on#mixPlay.playing::before{
    border-left-color:rgba(255,255,255,.95);
    border-right-color:rgba(255,255,255,.95);
  }
  
  .playBig{ 
    width:44px; 
    height:44px; 
    font-weight:700; 
  }
  .playBig::before{
    border-width:9px 0 9px 15px;
  }
  .playBig.playing::before{
    width:12px;
    height:18px;
    border-left-width:4px;
    border-right-width:4px;
  }
  
  /* Video player specific button styling - show text instead of CSS icons */
  #videoPlay,
  #videoPrev,
  #videoNext{
    font-size: 14px;
  }
  
  #videoPlay::before,
  #videoPrev::before,
  #videoNext::before{
    display: none !important;
  }
  
  #videoPlay.playing::before{
    display: none !important;
  }
  
  .vol{ 
    display:flex; 
    gap:10px; 
    min-width:140px; 
    align-items:center; 
  }
  
  /* Modern volume icon using CSS */
  .vol-icon{
    width:20px;
    height:20px;
    position:relative;
    display:flex;
    align-items:center;
  }
  
  .vol-icon::before{
    content:"";
    width:6px;
    height:8px;
    background:var(--text);
    border-radius:1px 0 0 1px;
  }
  
  .vol-icon::after{
    content:"";
    width:0;
    height:0;
    border-style:solid;
    border-width:6px 0 6px 6px;
    border-color:transparent transparent transparent var(--text);
    margin-left:-1px;
  }
  
  .vol-waves{
    position:absolute;
    left:12px;
    display:flex;
    gap:2px;
  }
  
  .vol-wave{
    width:2px;
    background:var(--text);
    border-radius:1px;
    opacity:.7;
  }
  
  .vol-wave:nth-child(1){ height:6px; }
  .vol-wave:nth-child(2){ height:10px; }
  .vol-wave:nth-child(3){ height:6px; }
  
  .vol span{ font-size:12px; }
  .vol input[type="range"]{ 
    width:100px;
    height:4px;
    -webkit-appearance:none;
    appearance:none;
    background:var(--finderHoverBg);
    border-radius:2px;
    cursor:pointer;
    position:relative;
  }
  
  /* Range track */
  .vol input[type="range"]::-webkit-slider-track{
    height:4px;
    background:var(--finderHoverBg);
    border-radius:2px;
  }
  
  .vol input[type="range"]::-moz-range-track{
    height:4px;
    background:var(--finderHoverBg);
    border-radius:2px;
  }
  
  /* Progress fill (filled part) */
  .vol input[type="range"]::-webkit-slider-runnable-track{
    height:4px;
    background:linear-gradient(to right, 
      rgba(80,150,255,.9) 0%, 
      rgba(80,150,255,.9) var(--volume-percent, 85%), 
      var(--finderHoverBg) var(--volume-percent, 85%), 
      var(--finderHoverBg) 100%);
    border-radius:2px;
  }
  
  .vol input[type="range"]::-moz-range-progress{
    height:4px;
    background:rgba(80,150,255,.9);
    border-radius:2px;
  }
  
  /* Range thumb */
  .vol input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none;
    width:12px;
    height:12px;
    background:rgba(80,150,255,.9);
    border-radius:50%;
    margin-top:-4px;
    box-shadow:0 2px 4px rgba(0,0,0,.2);
    cursor:pointer;
  }
  
  .vol input[type="range"]::-moz-range-thumb{
    width:12px;
    height:12px;
    background:rgba(80,150,255,.9);
    border:0;
    border-radius:50%;
    box-shadow:0 2px 4px rgba(0,0,0,.2);
    cursor:pointer;
  }
  
  .vol input[type="range"]:hover::-webkit-slider-thumb{
    background:rgba(80,150,255,1);
    transform:scale(1.15);
  }
  
  .vol input[type="range"]:hover::-moz-range-thumb{
    background:rgba(80,150,255,1);
    transform:scale(1.15);
  }
  .progress{
    margin-top:12px;
    padding:10px 12px;
    border-radius:6px;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
  }
  .pbar{
    height:8px;
    border-radius:4px;
    background: var(--finderHoverBg);
    overflow:hidden;
    cursor:pointer;
  }
  .pfill{
    height:100%;
    width:0%;
    background: rgba(80,150,255,.9);
    border-radius:4px;
  }
  .timeRow{
    display:flex;
    justify-content:space-between;
    font-size:12px;
    opacity:.7;
    margin-top:6px;
    color: var(--muted);
  }
  .trackList{
    margin-top:12px;
    border-radius:6px;
    overflow:hidden;
    border:1px solid var(--iconBorder);
    background: var(--finderBg);
  }
  .track{
    display:flex;
    justify-content:space-between;
    padding:12px;
    cursor:pointer;
    border-bottom:1px solid var(--iconBorder);
    transition:.12s ease;
  }
  .track:last-child{ border-bottom:0; }
  .track .left{ min-width:0; }
  .track .name{
    font-size:13px;
    font-weight:600;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    color: var(--text);
  }
  .track .sub{ font-size:12px; opacity:.65; margin-top:2px; color: var(--muted); }
  .track .right{ font-size:12px; opacity:.7; color: var(--muted); }
  .track:hover{ background: var(--finderHoverBg); }
  .track.active{ background: rgba(80,150,255,.15); }
  .playerHint{ margin-top:10px; font-size:12px; opacity:.7; color: var(--muted); }

  /* ===== iCloud Photos ===== */
  .icloudTop{
    padding:12px 16px;
    border-bottom:1px solid var(--iconBorder);
    display:flex;
    justify-content:space-between;
    gap:12px;
  }
  .icloudH1{ font-size:14px; font-weight:800; color: var(--text); }
  .icloudTabs{
    margin-top:8px;
    display:flex;
    gap:6px;
  }
  .icloudTab{
    border:1px solid var(--border);
    background: var(--finderBg);
    padding:6px 12px;
    border-radius:4px;
    cursor:pointer;
    font-size:12px;
    transition:.12s ease;
    color: var(--text);
  }
  .icloudTab:hover{ background: var(--finderHoverBg); }
  .icloudTab.active{
    background: rgba(80,150,255,.6);
    border-color: rgba(80,150,255,.8);
    color: rgba(255,255,255,.95);
  }
  .icloudSearch{
    width:min(240px, 40vw);
    border:1px solid var(--border);
    background: var(--finderBg);
    color: var(--text);
    padding:8px 12px;
    border-radius:4px;
    outline:none;
  }
  .icloudGrid{
    padding:16px;
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap:10px;
  }
  .photoTile{
    aspect-ratio:1/1;
    border-radius:6px;
    overflow:hidden;
    background: var(--finderBg);
    border:1px solid var(--iconBorder);
    cursor:pointer;
    transition:.12s ease;
  }
  .photoTile:hover{ transform: scale(1.02); }
  .photoTile img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  .photoTile.loading{
    cursor:default;
    background: var(--finderHoverBg);
    position:relative;
  }
  
  /* Simple static placeholder instead of animated shimmer */
  .photoTile.loading::after{
    content:"";
    position:absolute;
    inset:25%;
    border-radius:50%;
    background: var(--finderBg);
    opacity:.5;
  }

  .icloudViewer{
    position:fixed;
    inset:0;
    z-index:5000;
    background: rgba(0,0,0,.85);
    backdrop-filter: blur(16px);
    display:none;
  }
  .icloudViewer.open{ display:block; }
  .icloudViewerTop{
    height:48px;
    padding:0 16px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom:1px solid rgba(255,255,255,.1);
    background: rgba(30,30,35,.95);
  }
  .icloudViewerBtn{
    border:1px solid rgba(255,255,255,.15);
    background: rgba(255,255,255,.1);
    color: rgba(255,255,255,.95);
    padding:8px 16px;
    border-radius:4px;
    cursor:pointer;
    font-weight:600;
    font-size:12px;
    transition:.12s ease;
  }
  .icloudViewerBtn:hover{ background: rgba(255,255,255,.15); }
  .icloudViewerTitle{ font-size:13px; font-weight:700; color: rgba(255,255,255,.95); }
  .icloudViewerBody{
    height:calc(100vh - 48px);
    display:grid;
    place-items:center;
    padding:16px;
  }
  .icloudViewerBody img{
    max-width:min(960px, 94vw);
    max-height:min(700px, 80vh);
    border-radius:6px;
    box-shadow: 0 20px 80px rgba(0,0,0,.7);
    object-fit:contain;
  }

  /* ===== Mobile block ===== */
  .mobileBlock{
    position:fixed;
    bottom: 76px;
    right: 20px;
    z-index:8000;
    display:none;
    max-width: 400px;
  }
  
  .mobileBlock.show{
    display: block;
  }
  
  .mobileBlockCard{
    border-radius:12px;
    border:1px solid var(--border);
    background: var(--windowBg);
    box-shadow: 0 12px 40px rgba(0,0,0,.3);
    backdrop-filter: blur(20px);
    padding:20px;
  }
  .mobileH1{ 
    font-size:16px; 
    margin:0 0 12px; 
    font-weight: 700;
    color: var(--text);
  }
  .mobileP{ 
    margin:0 0 16px; 
    line-height:1.5; 
    font-size:14px; 
    color: var(--muted);
  }
  .mobileActions{ 
    display:flex; 
    gap:10px; 
    flex-wrap:wrap; 
  }
  .mobileBtn{
    border:1px solid var(--border);
    background: var(--finderBg);
    color: var(--text);
    padding:10px 16px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
    font-size:13px;
    transition:.15s ease;
  }
  .mobileBtn:hover{ 
    background: var(--finderHoverBg); 
  }
  .mobileBtn.primary{
    background: rgba(88,101,242,.9);
    border-color: rgba(88,101,242,1);
    color: white;
  }
  .mobileBtn.primary:hover{ 
    background: rgba(88,101,242,1); 
  }
  .mobileMeta{ 
    font-size:12px; 
    opacity:.65; 
    margin-top:12px; 
    color: var(--muted);
  }

  @media (max-width:520px){
    .finderGrid{ grid-template-columns: repeat(3, minmax(90px, 1fr)); }
    .icloudGrid{ grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); }
    .taskbar-app{ min-width:120px; }
  }

  @media (prefers-reduced-motion: reduce){
    .app, .menuWrap{ transition:none !important; }
  }
  
  /* ===== Login Modal ===== */
  .login-modal{
    position:fixed;
    inset:0;
    z-index:9000;
    background: rgba(0,0,0,.6);
    backdrop-filter: blur(8px);
    display:none;
    align-items:center;
    justify-content:center;
  }
  
  .login-modal.open{
    display:flex;
  }
  
  .login-box{
    width:min(420px, 90vw);
    background: var(--windowBg);
    border:1px solid var(--border);
    border-radius:12px;
    box-shadow: 0 20px 60px rgba(0,0,0,.4);
    overflow:hidden;
  }
  
  .login-header{
    padding:20px;
    text-align:center;
    border-bottom:1px solid var(--iconBorder);
  }
  
  .login-icon{
    width:64px;
    height:64px;
    margin:0 auto 12px;
    border-radius:50%;
    background: var(--finderBg);
    display:grid;
    place-items:center;
    font-size:32px;
  }
  
  .login-title{
    font-size:18px;
    font-weight:700;
    color: var(--text);
    margin-bottom:4px;
  }
  
  .login-subtitle{
    font-size:13px;
    color: var(--muted);
  }
  
  .login-body{
    padding:24px;
  }
  
  .login-field{
    margin-bottom:16px;
  }
  
  .login-label{
    display:flex;
    align-items:center;
    gap:8px;
    font-size:13px;
    color: var(--text);
    margin-bottom:8px;
    font-weight:600;
  }
  
  .login-input{
    width:100%;
    padding:12px 14px;
    border:1px solid var(--border);
    border-radius:8px;
    background: var(--finderBg);
    color: var(--text);
    font-size:14px;
    outline:none;
    transition:.15s ease;
    font-family: inherit;
  }
  
  .login-input:focus{
    border-color: rgba(80,150,255,.6);
    background: var(--finderHoverBg);
  }
  
  .login-actions{
    display:flex;
    gap:10px;
    margin-top:20px;
  }
  
  .login-btn{
    flex:1;
    padding:12px 20px;
    border:1px solid var(--border);
    border-radius:8px;
    font-size:14px;
    font-weight:600;
    cursor:pointer;
    transition:.15s ease;
    font-family: inherit;
  }
  
  .login-btn.cancel{
    background: var(--finderBg);
    color: var(--text);
  }
  
  .login-btn.cancel:hover{
    background: var(--finderHoverBg);
  }
  
  .login-btn.submit{
    background: rgba(80,150,255,.9);
    color: rgba(255,255,255,.98);
    border-color: rgba(80,150,255,1);
  }
  
  .login-btn.submit:hover{
    background: rgba(80,150,255,1);
    transform: translateY(-1px);
  }
  
  .lock-icon{
    font-size:16px;
  }
  
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
  }
  
  /* ===== SMS Notification ===== */
  .sms-notification{
    position: fixed;
    bottom: 70px;
    right: 20px;
    width: min(360px, calc(100vw - 40px));
    background: var(--windowBg);
    border: 1px solid var(--border);
    border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0,0,0,.3);
    backdrop-filter: blur(20px);
    overflow: hidden;
    z-index: 8000;
    opacity: 0;
    transform: translateY(20px) scale(0.95);
    transition: all .3s cubic-bezier(.2,.9,.3,1);
    pointer-events: none;
  }
  
  .sms-notification.show{
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: auto;
  }
  
  .sms-header{
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    background: var(--finderBg);
    border-bottom: 1px solid var(--iconBorder);
  }
  
  .sms-icon{
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(80,150,255,.8), rgba(120,100,255,.8));
    display: grid;
    place-items: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  
  .sms-header-text{
    flex: 1;
    min-width: 0;
  }
  
  .sms-title{
    font-size: 14px;
    font-weight: 700;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 6px;
  }
  
  .sms-app-name{
    font-size: 11px;
    opacity: .6;
    color: var(--muted);
  }
  
  .sms-time{
    font-size: 12px;
    opacity: .6;
    color: var(--muted);
    flex-shrink: 0;
  }
  
  .sms-body{
    padding: 16px;
  }
  
  .sms-message{
    font-size: 14px;
    line-height: 1.5;
    color: var(--text);
  }
  
  .sms-close{
    position: absolute;
    top: 12px;
    right: 12px;
    width: 24px;
    height: 24px;
    border-radius: 6px;
    border: 0;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    display: grid;
    place-items: center;
    font-size: 18px;
    transition: .15s ease;
    opacity: .6;
  }
  
  .sms-close:hover{
    background: var(--finderHoverBg);
    opacity: 1;
  }
  
  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  /* ===== SMS Conversation Window ===== */
  .sms-conversation{
    position: fixed;
    bottom: 70px;
    right: 20px;
    width: min(380px, calc(100vw - 40px));
    max-height: 500px;
    background: var(--windowBg);
    border: 1px solid var(--border);
    border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0,0,0,.3);
    backdrop-filter: blur(20px);
    overflow: hidden;
    z-index: 8500;
    opacity: 0;
    transform: translateY(20px) scale(0.95);
    transition: all .3s cubic-bezier(.2,.9,.3,1);
    pointer-events: none;
    display: flex;
    flex-direction: column;
  }
  
  .sms-conversation.show{
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: auto;
  }
  
  .sms-conv-header{
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    background: var(--finderBg);
    border-bottom: 1px solid var(--iconBorder);
  }
  
  .sms-conv-icon{
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(80,150,255,.8), rgba(120,100,255,.8));
    display: grid;
    place-items: center;
    font-size: 18px;
    flex-shrink: 0;
  }
  
  .sms-conv-info{
    flex: 1;
    min-width: 0;
  }
  
  .sms-conv-name{
    font-size: 14px;
    font-weight: 700;
    color: var(--text);
  }
  
  .sms-conv-status{
    font-size: 11px;
    opacity: .6;
    color: var(--muted);
  }
  
  .sms-conv-close{
    width: 28px;
    height: 28px;
    border-radius: 6px;
    border: 0;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    display: grid;
    place-items: center;
    font-size: 20px;
    transition: .15s ease;
  }
  
  .sms-conv-close:hover{
    background: var(--finderHoverBg);
  }
  
  .sms-conv-body{
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-height: 350px;
  }
  
  .sms-bubble{
    max-width: 85%;
    padding: 10px 14px;
    border-radius: 16px;
    font-size: 14px;
    line-height: 1.4;
    animation: bubbleIn 0.3s cubic-bezier(.2,.9,.3,1);
  }
  
  @keyframes bubbleIn {
    from {
      opacity: 0;
      transform: scale(0.9) translateY(10px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }
  
  .sms-bubble.received{
    align-self: flex-start;
    background: var(--finderBg);
    color: var(--text);
    border-bottom-left-radius: 4px;
  }
  
  .sms-bubble.sent{
    align-self: flex-end;
    background: rgba(80,150,255,.9);
    color: rgba(255,255,255,.98);
    border-bottom-right-radius: 4px;
  }
  
  .sms-options{
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
  }
  
  .sms-option{
    width: 100%;
    padding: 12px 16px;
    border: 1px solid var(--border);
    border-radius: 12px;
    background: var(--finderBg);
    color: var(--text);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: .15s ease;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .sms-option:hover{
    background: var(--finderHoverBg);
    transform: translateX(4px);
  }
  
  .sms-option:disabled{
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
  }
  
  .sms-option::before{
    content: "‚Üí";
    font-size: 16px;
    opacity: 0.6;
  }
  
  .sms-typing{
    align-self: flex-start;
    padding: 12px 16px;
    background: var(--finderBg);
    border-radius: 16px;
    border-bottom-left-radius: 4px;
    display: flex;
    gap: 4px;
    align-items: center;
  }
  
  .sms-typing-dot{
    width: 6px;
    height: 6px;
    background: var(--muted);
    border-radius: 50%;
    animation: typingDot 1.4s infinite;
  }
  
  .sms-typing-dot:nth-child(2){
    animation-delay: 0.2s;
  }
  
  .sms-typing-dot:nth-child(3){
    animation-delay: 0.4s;
  }
  
  @keyframes typingDot {
    0%, 60%, 100% {
      opacity: 0.3;
      transform: scale(0.8);
    }
    30% {
      opacity: 1;
      transform: scale(1);
    }
  }
</style>
</head>

<body>
  <!-- Splash Screen - Missing Person Report -->
  <div class="splash-screen" id="splashScreen">
    <div class="splash-left"></div>
    <div class="splash-right">
      <div class="splash-content">
        <h1 class="splash-title">Zg≈Çoszenie osoby zaginionej</h1>
        <p class="splash-subtitle">
          Je≈õli posiadasz informacje o miejscu pobytu osoby zaginionej,<br>
          prosimy o wype≈Çnienie formularza zg≈Çoszeniowego.
        </p>
        <button class="splash-button" id="splashButton">
          Przejd≈∫ do formularza
        </button>
      </div>
    </div>
  </div>

  <!-- Blue Screen of Death -->
  <div class="bluescreen" id="bluescreen">
    <div class="bsod-emoji">:(</div>
    <div class="bsod-title">Your PC ran into a problem and needs to restart.</div>
    <div class="bsod-text">We're just collecting some error info, and then we'll restart for you.</div>
    <div class="bsod-percentage" id="bsodPercentage">0% complete</div>
    <div class="bsod-error">
      Stop code: CRITICAL_PROCESS_DIED
    </div>
  </div>

  <!-- Safe Boot Screen -->
  <div class="safeboot-screen" id="safebootScreen">
    <div class="safeboot-title">Starting system in Safe Mode...</div>
  </div>

  <!-- System Loading Screen -->
  <div class="system-loading" id="systemLoading">
    <div class="system-logo">‚öôÔ∏è</div>
    <div class="system-text">
      Inicjalizacja systemu...<br>
      ≈Åadowanie modu≈Ç√≥w...
    </div>
    <div class="system-progress">
      <div class="system-progress-bar"></div>
    </div>
    <button class="system-login-btn" id="systemLoginBtn">
      ZALOGUJ
    </button>
  </div>

  <!-- Mobile block -->
  <div class="mobileBlock" id="mobileBlock">
    <div class="mobileBlockCard">
      <div class="mobileH1">üì± UrzƒÖdzenie mobilne wykryte</div>
      <p class="mobileP">
        Strona jest zoptymalizowana dla desktop√≥w, ale mo≈ºesz korzystaƒá z niej na telefonie. Niekt√≥re funkcje mogƒÖ dzia≈Çaƒá lepiej na wiƒôkszym ekranie.
      </p>
      <div class="mobileActions">
        <button class="mobileBtn primary" id="continueAnywayBtn">Rozumiem, kontynuuj</button>
        <button class="mobileBtn" id="copyLinkBtn">Skopiuj link</button>
      </div>
      <div class="mobileMeta" id="mobileMeta"></div>
    </div>
  </div>

  <div class="wallpaper"></div>
  <div class="brandBlur"></div>
  <div class="grain"></div>

  <!-- Desktop icons -->
  <div class="icons">
    <div class="icon" id="driveLauncher">
      <div class="pic"><img src="drive.png" alt="" class="deskIconImg"></div>
      <div>Dysk</div>
    </div>

    <div class="icon" id="folderLauncher">
      <div class="pic"><img src="files.png" alt="" class="deskIconImg"></div>
      <div>Folder</div>
    </div>

    <div class="icon" id="appLauncher">
      <div class="pic"><img src="freewifi.png" alt="" class="deskIconImg"></div>
      <div>godwifi</div>
    </div>
    
    <div class="icon" id="binLauncher">
      <div class="pic"><img src="files.png" alt="" class="deskIconImg"></div>
      <div>Kosz</div>
    </div>
  </div>

  <!-- Stage -->
  <div class="stage" id="stage">
    <!-- Main app window -->
    <section class="app" id="app">
      <div class="titlebar" data-drag="app">
        <div class="title">godwifi</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="appMin">‚àí</button>
          <button class="win-btn maximize" id="appMax">‚ñ°</button>
          <button class="win-btn close" id="appClose">√ó</button>
        </div>
      </div>

      <div class="content">
        <button class="logoBtn" id="toggle">
          <img class="logo" id="logo" src="freewifi.png" alt="godwifi logo">
        </button>
        <div class="hint" id="hint">Kliknij logo, aby rozwinƒÖƒá</div>

        <div class="menuWrap" id="menuWrap">
          <nav class="menu">
            <a href="https://instagram.com/tokarz_k" target="_blank" rel="noopener">Sprawd≈∫ Instagram Gumisia</a>
            <a href="https://instagram.com/god.wifi" target="_blank" rel="noopener">Sprawd≈∫ Instagram god.wifi</a>
            <a id="spotifyLink" href="#" target="_blank" rel="noopener">Sprawd≈∫ Spotify</a>
            <a id="discordLink" class="discord" href="#" target="_blank" rel="noopener">Wejd≈∫ na Discord</a>
          </nav>
        </div>
      </div>
    </section>

    <!-- Finder root -->
    <section class="app finder" id="finderWin">
      <div class="titlebar" data-drag="finderWin">
        <div class="title">Folder</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="finderMin">‚àí</button>
          <button class="win-btn maximize" id="finderMax">‚ñ°</button>
          <button class="win-btn close" id="finderClose">√ó</button>
        </div>
      </div>

      <div class="finderPath">~/</div>
      <div class="finderBody">
        <div class="finderGrid">
          <button class="finderItem" id="openKoncert">
            <img src="files.png" alt="" class="finderIcon">
            <span>koncert</span>
          </button>

          <button class="finderItem" id="openMix">
            <img src="files.png" alt="" class="finderIcon">
            <span>mix</span>
          </button>

          <button class="finderItem">
            <img src="files.png" alt="" class="finderIcon">
            <span>projekty</span>
          </button>

          <button class="finderItem">
            <img src="files.png" alt="" class="finderIcon">
            <span>grafika</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Koncert -->
    <section class="app finder" id="koncertWin">
      <div class="titlebar" data-drag="koncertWin">
        <div class="title">koncert</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="koncertMin">‚àí</button>
          <button class="win-btn maximize" id="koncertMax">‚ñ°</button>
          <button class="win-btn close" id="koncertClose">√ó</button>
        </div>
      </div>

      <div class="finderPath">~/koncert</div>
      <div class="finderBody">
        <div class="finderGrid">
          <button class="finderItem">
            <img src="files.png" alt="" class="finderIcon">
            <span>zdjƒôcia</span>
          </button>

          <button class="finderItem">
            <img src="files.png" alt="" class="finderIcon">
            <span>wideo</span>
          </button>

          <button class="finderItem" id="openSetlista">
            <img src="drive.png" alt="" class="finderIcon">
            <span>setlista</span>
            <div class="fileBadge">plik</div>
          </button>

          <button class="finderItem">
            <img src="drive.png" alt="" class="finderIcon">
            <span>info</span>
            <div class="fileBadge">plik</div>
          </button>
        </div>
      </div>
    </section>

    <!-- Notes -->
    <section class="app notes" id="notesWin">
      <div class="titlebar" data-drag="notesWin">
        <div class="title">Notatki</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="notesMin">‚àí</button>
          <button class="win-btn maximize" id="notesMax">‚ñ°</button>
          <button class="win-btn close" id="notesClose">√ó</button>
        </div>
      </div>

      <div class="notesWrap">
        <aside class="notesSidebar">
          <div class="notesSideTitle">Notatki</div>
          <div class="notesItem">
            <div>setlista</div>
            <div style="font-size:11px;opacity:.6;margin-top:4px;">warszawa, 7/11‚Ä¶</div>
          </div>
        </aside>

        <main class="notesEditor">
          <h2 style="margin:0 0 12px;font-size:16px;">setlista</h2>
          <div class="notePaper">
            <ol>
              <li>warszawa (2:32)</li>
              <li>7/11 (2:05)</li>
              <li>sweet (2:04)</li>
              <li>emoji (1:48)</li>
              <li>pingwin (2:24) ‚Äî ≈ªabson, Drabusheyka</li>
              <li>2late (2:17)</li>
              <li>hentai haze (1:39) ‚Äî Chlor</li>
              <li>moshpit (2:02)</li>
              <li>dj (1:46)</li>
              <li>usa (2:09)</li>
              <li>sms (2:49)</li>
              <li>pijama party (1:38)</li>
              <li>everyday (1:37)</li>
              <li>twilight zone (1:39)</li>
              <li><strong>free wifi</strong> (1:48)</li>
            </ol>
          </div>
        </main>
      </div>
    </section>

    <!-- Mix player -->
    <section class="app finder" id="mixWin">
      <div class="titlebar" data-drag="mixWin">
        <div class="title">mix</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="mixMin">‚àí</button>
          <button class="win-btn maximize" id="mixMax">‚ñ°</button>
          <button class="win-btn close" id="mixClose">√ó</button>
        </div>
      </div>

      <div class="player">
        <div class="playerBar">
          <div class="now">
            <div class="title" id="mixNowTitle">‚Äî</div>
            <div class="meta" id="mixNowMeta">Full track ¬∑ Space ¬∑ ‚Üê/‚Üí ¬∑ S ¬∑ R</div>
          </div>

          <div class="ctrl">
            <button class="mbtn" id="mixShuffle" title="Shuffle (S)"></button>
            <button class="mbtn" id="mixPrev" title="Previous (‚Üê)"></button>
            <button class="mbtn playBig" id="mixPlay" title="Play/Pause (Space)"></button>
            <button class="mbtn" id="mixNext" title="Next (‚Üí)"></button>
            <button class="mbtn" id="mixRepeat" title="Repeat (R)"></button>
          </div>

          <div class="vol">
            <div class="vol-icon">
              <div class="vol-waves">
                <span class="vol-wave"></span>
                <span class="vol-wave"></span>
                <span class="vol-wave"></span>
              </div>
            </div>
            <input id="mixVol" type="range" min="0" max="1" step="0.01" value="0.85" />
          </div>
        </div>

        <div class="progress">
          <div class="pbar" id="mixPbar">
            <div class="pfill" id="mixPfill"></div>
          </div>
          <div class="timeRow">
            <span id="mixTcur">0:00</span>
            <span id="mixTend">0:20</span>
          </div>
        </div>

        <div class="trackList" id="mixList"></div>
        <div class="playerHint">Pe≈Çne utwory. Automatycznie przechodzi do nastƒôpnego. Zamkniƒôcie/minimalizacja zatrzymuje muzykƒô.</div>
        <audio id="mixAudio" preload="metadata"></audio>
      </div>
    </section>

    <!-- Drive -->
    <section class="app finder" id="driveWin">
      <div class="titlebar" data-drag="driveWin">
        <div class="title">Dysk</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="driveMin">‚àí</button>
          <button class="win-btn maximize" id="driveMax">‚ñ°</button>
          <button class="win-btn close" id="driveClose">√ó</button>
        </div>
      </div>

      <div class="finderPath">~/Dysk</div>
      <div class="finderBody">
        <div class="finderGrid">
          <button class="finderItem" id="openIcloudPhotos">
            <img src="Galeria iCloud ikona.png" alt="" class="finderIcon">
            <span>Galeria iCloud</span>
          </button>
          
          <button class="finderItem" id="openArchive">
            <img src="files.png" alt="" class="finderIcon">
            <span>Archiwum</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Bin (Kosz) -->
    <section class="app finder" id="binWin">
      <div class="titlebar" data-drag="binWin">
        <div class="title">Kosz</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="binMin">‚àí</button>
          <button class="win-btn maximize" id="binMax">‚§¢</button>
          <button class="win-btn close" id="binClose">√ó</button>
        </div>
      </div>

      <div class="finderPath">~/Kosz</div>
      <div class="finderBody">
        <div class="finderGrid">
          <button class="finderItem">
            <img src="notepad.png" alt="" class="finderIcon notepad-icon">
            <span>premiera</span>
            <div class="fileBadge">.txt</div>
          </button>

          <button class="finderItem">
            <img src="notepad.png" alt="" class="finderIcon notepad-icon">
            <span>koncept</span>
            <div class="fileBadge">.txt</div>
          </button>

          <button class="finderItem">
            <img src="notepad.png" alt="" class="finderIcon notepad-icon">
            <span>featy</span>
            <div class="fileBadge">.txt</div>
          </button>

          <button class="finderItem" id="openBinPhoto">
            <img src="drive.png" alt="" class="finderIcon">
            <span>file_00000000...</span>
            <div class="fileBadge">.png</div>
          </button>
        </div>
      </div>
    </section>

    <!-- Photos -->
    <section class="app finder" id="photosWin">
      <div class="titlebar" data-drag="photosWin">
        <div class="title">iCloud Photos</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="photosMin">‚àí</button>
          <button class="win-btn maximize" id="photosMax">‚ñ°</button>
          <button class="win-btn close" id="photosClose">√ó</button>
        </div>
      </div>

      <div class="icloudTop">
        <div>
          <div class="icloudH1">Zdjƒôcia</div>
          <div class="icloudTabs">
            <button class="icloudTab active" data-tab="recent">Ostatnie</button>
            <button class="icloudTab" data-tab="albums">Albumy</button>
            <button class="icloudTab" data-tab="shared">Udostƒôpnione</button>
          </div>
        </div>
        <input class="icloudSearch" id="icloudSearch" placeholder="Szukaj">
      </div>

      <div class="icloudGrid" id="icloudGrid"></div>
    </section>

    <!-- Game -->
    <section class="app game" id="gameWin">
      <div class="titlebar" data-drag="gameWin">
        <div class="title">Wi-Fi Runner</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="gameMin">‚àí</button>
          <button class="win-btn maximize" id="gameMax">‚ñ°</button>
          <button class="win-btn close" id="gameClose">√ó</button>
        </div>
      </div>

      <div class="gameWrap">
        <div class="gameTop">
          <div>Score: <span id="score">0</span> ¬∑ Best: <span id="best">0</span></div>
          <div id="gameState">Kliknij / Space aby start</div>
        </div>
        <canvas id="dinoCanvas" width="900" height="260"></canvas>
        <div class="gameHint">Sterowanie: <b>Space</b> / <b>‚Üë</b> / klik ‚Äî skok. Po przegranej: Space aby restart.</div>
      </div>
    </section>

    <!-- Video Player -->
    <section class="app finder" id="videoWin" style="width: min(750px, 90vw); max-height: 85vh;">
      <div class="titlebar" data-drag="videoWin">
        <div class="title">Odtwarzacz wideo</div>
        <div class="window-controls">
          <button class="win-btn minimize" id="videoMin">‚àí</button>
          <button class="win-btn maximize" id="videoMax">‚§¢</button>
          <button class="win-btn close" id="videoClose">√ó</button>
        </div>
      </div>

      <div class="player" style="padding: 12px;">
        <video id="videoPlayer" controls style="
          width: 100%;
          border-radius: 8px;
          background: #000;
          max-height: 400px;
        "></video>
        
        <div class="playerBar" style="margin-top: 12px;">
          <div class="now" style="min-width: 150px;">
            <div class="title" id="videoNowTitle">‚Äî</div>
            <div class="meta">Kliknij film aby odtworzyƒá</div>
          </div>

          <div class="ctrl">
            <button class="mbtn" id="videoPrev" title="Poprzedni">‚óÄ</button>
            <button class="mbtn playBig" id="videoPlay" title="Play/Pause">‚ñ∂</button>
            <button class="mbtn" id="videoNext" title="Nastƒôpny">‚ñ∂</button>
          </div>

          <div class="vol">
            <div class="vol-icon">
              <div class="vol-waves">
                <span class="vol-wave"></span>
                <span class="vol-wave"></span>
                <span class="vol-wave"></span>
              </div>
            </div>
            <input id="videoVol" type="range" min="0" max="1" step="0.01" value="0.85" />
          </div>
        </div>

        <div class="trackList" id="videoList" style="margin-top: 12px; max-height: 180px; overflow-y: auto;"></div>
      </div>
    </section>
  </div>

  <!-- iCloud viewer -->
  <div class="icloudViewer" id="icloudViewer">
    <div class="icloudViewerTop">
      <button class="icloudViewerBtn" id="icloudViewerClose">Gotowe</button>
      <div class="icloudViewerTitle" id="icloudViewerTitle">Zdjƒôcie</div>
      <div style="width:72px;"></div>
    </div>
    <div class="icloudViewerBody">
      <img id="icloudViewerImg" alt="">
    </div>
  </div>

  <!-- SMS Notification -->
  <div class="sms-notification" id="smsNotification">
    <button class="sms-close" id="smsClose">√ó</button>
    <div class="sms-header">
      <div class="sms-icon">üí¨</div>
      <div class="sms-header-text">
        <div class="sms-title">
          <span>hidden_user</span>
          <span class="sms-app-name">SMS</span>
        </div>
      </div>
      <div class="sms-time" id="smsTime">1 min temu</div>
    </div>
    <div class="sms-body">
      <div class="sms-message">Jakie jest has≈Ço do wifi?</div>
    </div>
  </div>

  <!-- SMS Conversation Window -->
  <div class="sms-conversation" id="smsConversation">
    <div class="sms-conv-header">
      <div class="sms-conv-icon">üí¨</div>
      <div class="sms-conv-info">
        <div class="sms-conv-name">hidden_user</div>
        <div class="sms-conv-status">SMS</div>
      </div>
      <button class="sms-conv-close" id="smsConvClose">√ó</button>
    </div>
    <div class="sms-conv-body" id="smsConvBody">
      <div class="sms-bubble received">Jakie jest has≈Ço do wifi?</div>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="login-modal" id="loginModal">
    <div class="login-box">
      <div class="login-header">
        <div class="login-icon">üîí</div>
        <div class="login-title">Zaloguj siƒô</div>
        <div class="login-subtitle">Wpisz login i has≈Ço aby uzyskaƒá dostƒôp</div>
      </div>
      
      <div class="login-body">
        <div class="login-field">
          <label class="login-label">
            <span class="lock-icon">üë§</span>
            <span>Login</span>
          </label>
          <input type="text" class="login-input" id="loginUsername" placeholder="Wpisz login">
        </div>
        
        <div class="login-field">
          <label class="login-label">
            <span class="lock-icon">üîê</span>
            <span>Has≈Ço</span>
          </label>
          <input type="text" class="login-input" id="loginPassword" placeholder="Wpisz has≈Ço" readonly style="cursor: text;">
        </div>
        
        <div class="login-actions">
          <button class="login-btn cancel" id="loginCancel">Anuluj</button>
          <button class="login-btn submit" id="loginSubmit">Zaloguj</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Photo Login Modal -->
  <div class="login-modal" id="photoLoginModal">
    <div class="login-box">
      <div class="login-header">
        <div class="login-icon">üîí</div>
        <div class="login-title">Dostƒôp do pliku</div>
        <div class="login-subtitle">Wpisz login i has≈Ço aby otworzyƒá zdjƒôcie</div>
      </div>
      
      <div class="login-body">
        <div class="login-field">
          <label class="login-label">
            <span class="lock-icon">üë§</span>
            <span>Login</span>
          </label>
          <input type="text" class="login-input" id="photoLoginUsername" placeholder="Wpisz login">
        </div>
        
        <div class="login-field">
          <label class="login-label">
            <span class="lock-icon">üîê</span>
            <span>Has≈Ço</span>
          </label>
          <input type="text" class="login-input" id="photoLoginPassword" placeholder="Wpisz has≈Ço" readonly style="cursor: text;">
        </div>
        
        <div class="login-actions">
          <button class="login-btn cancel" id="photoLoginCancel">Anuluj</button>
          <button class="login-btn submit" id="photoLoginSubmit">Zaloguj</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Windows-style Taskbar -->
  <div class="taskbar">
    <div class="taskbar-left">
      <div class="start-btn" id="startBtn" title="Start">‚äû</div>
      
      <div class="taskbar-app" id="taskApp" style="display:none;">
        <img src="freewifi.png" class="taskbar-icon" alt="">
        <span>godwifi</span>
      </div>

      <div class="taskbar-app" id="taskFinder" style="display:none;">
        <img src="files.png" class="taskbar-icon" alt="">
        <span>Folder</span>
      </div>

      <div class="taskbar-app" id="taskGame" style="display:none;">
        <span>üéÆ</span>
        <span>Wi-Fi Runner</span>
      </div>
      
      <!-- Social media apps -->
      <div class="taskbar-separator"></div>
      
      <div class="taskbar-app taskbar-social" id="taskInstagram" title="Instagram">
        <img src="Instagram_icon.png" class="taskbar-icon" alt="">
        <span>Instagram</span>
      </div>

      <div class="taskbar-app taskbar-social" id="taskSpotify" title="Spotify">
        <img src="Spotify_App_Logo.svg.png" class="taskbar-icon" alt="">
        <span>Spotify</span>
      </div>

      <div class="taskbar-app taskbar-social" id="taskDiscord" title="Discord">
        <img src="discord-logo-icon-editorial-free-vector.png" class="taskbar-icon" alt="">
        <span>Discord</span>
      </div>
    </div>

    <div class="taskbar-right">
      <div class="system-tray">
        <div class="tray-icon" id="wifiBtn" title="Wi-Fi Runner">
          <span class="wifi-icon">
            <span class="wifi-dot"></span>
          </span>
        </div>
        
        <div class="battery" id="battery">
          <div class="batteryIcon">
            <div class="batteryLevel" id="batteryLevel"></div>
            <div class="batteryCap"></div>
            <div class="batteryBolt" id="batteryBolt">‚ö°</div>
          </div>
          <div style="font-variant-numeric: tabular-nums;" id="batteryPct">--%</div>
        </div>

        <div id="clock" style="font-variant-numeric: tabular-nums;"></div>
      </div>
    </div>
  </div>

  <script>
  // ====== MAINTENANCE MODE ======
  const MAINTENANCE = true;
  const PASSWORD = "g0dwifi";

  function isUnlocked() {
    const params = new URLSearchParams(location.search);
    if (params.get("unlock") === PASSWORD) return true;
    if (localStorage.getItem("godwifi_unlocked") === "1") return true;
    return false;
  }

  function showLockScreen() {
    document.documentElement.style.background = "#0b0b0c";
    document.body.innerHTML = `
      <div style="
        min-height:100vh; display:grid; place-items:center;
        font-family: 'Segoe UI', Ubuntu, Arial, sans-serif;
        color: rgba(255,255,255,.92);
        background: radial-gradient(800px 500px at 20% 20%, rgba(80,120,255,.2), transparent 60%),
                    linear-gradient(180deg,#0a0c14,#050507);
      ">
        <div style="
          width:min(420px,92vw);
          padding:24px 20px;
          border-radius:8px;
          background: rgba(40,40,45,.95);
          border:1px solid rgba(255,255,255,.15);
          backdrop-filter: blur(18px);
          box-shadow: 0 30px 90px rgba(0,0,0,.6);
          text-align:center;
        ">
          <div style="font-size:14px; opacity:.85; margin-bottom:8px;">godwifi</div>
          <div style="font-size:18px; font-weight:700; margin-bottom:10px;">Tryb test√≥w</div>
          <div style="font-size:13px; opacity:.75; margin-bottom:16px;">
            Strona chwilowo niedostƒôpna. Je≈õli masz dostƒôp, wpisz has≈Ço.
          </div>

          <input id="pw" type="password" placeholder="Has≈Ço"
            style="
              width:100%; padding:12px; border-radius:6px;
              border:1px solid rgba(255,255,255,.15);
              background: rgba(255,255,255,.08);
              color: rgba(255,255,255,.92);
              outline:none;
            " />

          <button id="go"
            style="
              width:100%; margin-top:10px; padding:12px;
              border-radius:6px; border:1px solid rgba(255,255,255,.15);
              background: rgba(255,255,255,.14);
              color: rgba(255,255,255,.92);
              font-weight:700;
              cursor:pointer;
            "
          >Wejd≈∫</button>

          <div id="err" style="margin-top:10px; font-size:12px; opacity:.7;"></div>
        </div>
      </div>
    `;

    const pw = document.getElementById("pw");
    const go = document.getElementById("go");
    const err = document.getElementById("err");

    function attempt() {
      if (pw.value === PASSWORD) {
        localStorage.setItem("godwifi_unlocked", "1");
        location.href = location.origin + location.pathname;
      } else {
        err.textContent = "Z≈Çe has≈Ço.";
      }
    }

    go.addEventListener("click", attempt);
    pw.addEventListener("keydown", (e) => {
      if (e.key === "Enter") attempt();
    });
  }

  if (MAINTENANCE && !isUnlocked()) {
    document.addEventListener("DOMContentLoaded", showLockScreen);
  }
</script>

<script>
  // ===== Mobile notice =====
  (function(){
    const block = document.getElementById("mobileBlock");
    if (!block) return;

    const meta = document.getElementById("mobileMeta");
    const btnCopy = document.getElementById("copyLinkBtn");
    const btnContinue = document.getElementById("continueAnywayBtn");

    const ua = navigator.userAgent || "";
    const isTouch = navigator.maxTouchPoints > 0;
    const smallScreen = Math.min(window.innerWidth, window.innerHeight) <= 820;
    const isMobileLike = /Android|iPhone|iPad|iPod|Windows Phone/i.test(ua) || (isTouch && smallScreen);

    function show(){
      block.classList.add("show");
    }

    function hide(){
      block.classList.remove("show");
    }

    if (isMobileLike){
      const device = /iPhone|iPad|iPod/i.test(ua) ? "iOS" :
                     /Android/i.test(ua) ? "Android" : "Mobile";
      meta.textContent = `Wykryto: ${device} ¬∑ ${window.innerWidth}√ó${window.innerHeight}`;
      
      // Show notice after splash screen sequence
      setTimeout(() => {
        show();
      }, 2000);
      
      // Auto-hide after 8 seconds
      setTimeout(() => {
        hide();
      }, 10000);
    }

    btnContinue?.addEventListener("click", () => hide());

    btnCopy?.addEventListener("click", async () => {
      try{
        await navigator.clipboard.writeText(location.href);
        btnCopy.textContent = "Skopiowano ‚úÖ";
        setTimeout(()=> btnCopy.textContent = "Skopiuj link", 1400);
      }catch(e){
        prompt("Skopiuj link:", location.href);
      }
    });
  })();

  // ===== LINKS =====
  const IG_GUMIS = "https://instagram.com/tokarz_k";
  const IG_GODWIFI = "https://instagram.com/god.wifi";
  const SPOTIFY_URL = "https://open.spotify.com/artist/6iz52ADwFl483ghAI7NuS1?si=V1A-TzIoRNqL1iQ_ptCGng";
  const DISCORD_URL = "https://discord.gg/4PTQRsUq9t";

  document.getElementById("spotifyLink").href = SPOTIFY_URL;
  document.getElementById("discordLink").href = DISCORD_URL;

  const prefersReduced = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  // ===== Splash Screen Sequence =====
  const splashScreen = document.getElementById("splashScreen");
  const splashButton = document.getElementById("splashButton");
  const bluescreen = document.getElementById("bluescreen");
  const bsodPercentage = document.getElementById("bsodPercentage");
  const safebootScreen = document.getElementById("safebootScreen");
  const systemLoading = document.getElementById("systemLoading");
  const systemLoginBtn = document.getElementById("systemLoginBtn");
  
  let hasSeenSplash = sessionStorage.getItem("hasSeenSplash");
  
  // Skip splash if already seen in this session
  if (hasSeenSplash) {
    splashScreen.classList.add("hidden");
  }
  
  const safebootMessages = [
    "Loading system drivers...",
    "Initializing hardware...",
    "Starting ACPI subsystem...",
    "Loading USB drivers...",
    "Detecting storage devices...",
    "Mounting filesystems...",
    "Starting network services...",
    "Loading audio drivers...",
    "Initializing graphics...",
    "Starting system services...",
    "Loading kernel modules...",
    "Checking disk integrity...",
    "Starting security services...",
    "Initializing user environment...",
    "System ready for login..."
  ];
  
  splashButton.addEventListener("click", () => {
    // Mark as seen
    sessionStorage.setItem("hasSeenSplash", "true");
    
    // Show bluescreen
    bluescreen.classList.add("active");
    splashScreen.style.display = "none";
    
    // Animate percentage from 0 to 100
    let percent = 0;
    const percentInterval = setInterval(() => {
      percent += 3;
      if (percent > 100) percent = 100;
      bsodPercentage.textContent = `${percent}% complete`;
      
      if (percent >= 100) {
        clearInterval(percentInterval);
        
        // After reaching 100%, wait 500ms then show safe boot
        setTimeout(() => {
          bluescreen.classList.remove("active");
          safebootScreen.classList.add("active");
          
          // Add safe boot messages one by one
          let messageIndex = 0;
          const messageInterval = setInterval(() => {
            if (messageIndex < safebootMessages.length) {
              const line = document.createElement("div");
              line.className = "safeboot-line ok";
              line.textContent = safebootMessages[messageIndex];
              line.style.animationDelay = `${messageIndex * 0.05}s`;
              safebootScreen.appendChild(line);
              messageIndex++;
            } else {
              clearInterval(messageInterval);
              
              // After all messages, transition to system loading
              setTimeout(() => {
                safebootScreen.style.opacity = "0";
                safebootScreen.style.transition = "opacity 0.5s ease";
                
                setTimeout(() => {
                  safebootScreen.classList.remove("active");
                  systemLoading.classList.add("active");
                }, 500);
              }, 500);
            }
          }, 100); // Show each message every 100ms
        }, 500);
      }
    }, 90); // Update percentage every 90ms (3 seconds total)
  });
  
  systemLoginBtn.addEventListener("click", () => {
    // Fade out system loading
    systemLoading.style.opacity = "0";
    systemLoading.style.transition = "opacity 0.5s ease";
    
    setTimeout(() => {
      systemLoading.classList.remove("active");
      systemLoading.style.display = "none";
    }, 500);
  });

  // ===== SMS Notification =====
  const smsNotification = document.getElementById("smsNotification");
  const smsClose = document.getElementById("smsClose");
  const smsTime = document.getElementById("smsTime");
  const smsConversation = document.getElementById("smsConversation");
  const smsConvBody = document.getElementById("smsConvBody");
  const smsConvClose = document.getElementById("smsConvClose");
  
  let conversationState = 0; // 0 = initial, 1 = first option tried, 2 = second option (correct)
  
  function showSMSNotification(){
    // Calculate time 1 minute ago
    const now = new Date();
    const oneMinAgo = new Date(now.getTime() - 60000);
    const hours = String(oneMinAgo.getHours()).padStart(2, '0');
    const minutes = String(oneMinAgo.getMinutes()).padStart(2, '0');
    
    smsTime.textContent = `${hours}:${minutes}`;
    
    // Show notification after a short delay
    setTimeout(() => {
      smsNotification.classList.add('show');
    }, 1500);
  }
  
  function hideSMSNotification(){
    smsNotification.classList.remove('show');
  }
  
  function showSMSConversation(){
    hideSMSNotification();
    smsConversation.classList.add('show');
    
    // Show initial options if not already shown
    if (conversationState === 0) {
      setTimeout(() => {
        showPasswordOptions();
      }, 300);
    }
  }
  
  function hideSMSConversation(){
    smsConversation.classList.remove('show');
  }
  
  function addMessage(text, type = 'received', delay = 0){
    setTimeout(() => {
      const bubble = document.createElement('div');
      bubble.className = `sms-bubble ${type}`;
      bubble.textContent = text;
      smsConvBody.appendChild(bubble);
      smsConvBody.scrollTop = smsConvBody.scrollHeight;
    }, delay);
  }
  
  function showTypingIndicator(){
    const typing = document.createElement('div');
    typing.className = 'sms-typing';
    typing.id = 'typingIndicator';
    typing.innerHTML = `
      <span class="sms-typing-dot"></span>
      <span class="sms-typing-dot"></span>
      <span class="sms-typing-dot"></span>
    `;
    smsConvBody.appendChild(typing);
    smsConvBody.scrollTop = smsConvBody.scrollHeight;
  }
  
  function removeTypingIndicator(){
    const typing = document.getElementById('typingIndicator');
    if (typing) typing.remove();
  }
  
  function showPasswordOptions(){
    const optionsContainer = document.createElement('div');
    optionsContainer.className = 'sms-options';
    optionsContainer.id = 'passwordOptions';
    
    const options = [
      { text: 'Spr√≥buj: 22032026', password: '22032026', correct: false },
      { text: 'Spr√≥buj: 17042026', password: '17042026', correct: true },
      { text: 'Spr√≥buj: 2137420', password: '2137420', correct: false }
    ];
    
    options.forEach((option, index) => {
      const btn = document.createElement('button');
      btn.className = 'sms-option';
      btn.textContent = option.text;
      btn.dataset.password = option.password;
      btn.dataset.correct = option.correct;
      btn.dataset.index = index;
      
      btn.addEventListener('click', () => handlePasswordOption(btn));
      
      optionsContainer.appendChild(btn);
    });
    
    smsConvBody.appendChild(optionsContainer);
    smsConvBody.scrollTop = smsConvBody.scrollHeight;
  }
  
  function handlePasswordOption(btn){
    const password = btn.dataset.password;
    const isCorrect = btn.dataset.correct === 'true';
    const index = parseInt(btn.dataset.index);
    
    // Disable all options temporarily
    const allOptions = document.querySelectorAll('.sms-option');
    allOptions.forEach(opt => opt.disabled = true);
    
    // Send user message
    addMessage(password, 'sent', 100);
    
    // Show typing indicator
    setTimeout(() => {
      showTypingIndicator();
    }, 800);
    
    // Response after 3 seconds
    setTimeout(() => {
      removeTypingIndicator();
      
      if (isCorrect) {
        // Correct password!
        addMessage('Super! Dzia≈Ça, dziƒôkujƒô! üéâ', 'received', 100);
        
        // Remove all options
        setTimeout(() => {
          const optionsEl = document.getElementById('passwordOptions');
          if (optionsEl) optionsEl.remove();
        }, 500);
        
        conversationState = 2;
      } else {
        // Wrong password
        addMessage('Nie dzia≈Ça üòï', 'received', 100);
        
        // Remove only the wrong option and re-enable the rest
        setTimeout(() => {
          // Remove the wrong button
          btn.style.opacity = '0';
          btn.style.transform = 'scale(0.8)';
          
          setTimeout(() => {
            btn.remove();
            
            // Re-enable all remaining options
            const remainingOptions = document.querySelectorAll('.sms-option');
            remainingOptions.forEach(opt => {
              opt.disabled = false;
            });
            
            conversationState = 1;
          }, 300);
        }, 800);
      }
    }, 3000);
  }
  
  smsClose.addEventListener('click', hideSMSNotification);
  
  // Click notification to open conversation
  smsNotification.addEventListener('click', (e) => {
    if (e.target !== smsClose) {
      showSMSConversation();
    }
  });
  
  smsConvClose.addEventListener('click', hideSMSConversation);
  
  // SMS notification stays visible until manually closed - no auto-hide
  
  // Show SMS on page load
  showSMSNotification();

  // ===== Social media taskbar buttons =====
  const taskInstagram = document.getElementById("taskInstagram");
  const taskSpotify = document.getElementById("taskSpotify");
  const taskDiscord = document.getElementById("taskDiscord");
  
  // Instagram - show dropdown menu
  let igMenuOpen = false;
  
  taskInstagram.addEventListener("click", (e) => {
    e.stopPropagation();
    
    // Toggle menu
    igMenuOpen = !igMenuOpen;
    
    if (igMenuOpen) {
      // Create dropdown menu
      const menu = document.createElement("div");
      menu.id = "igTaskMenu";
      menu.style.cssText = `
        position: fixed;
        bottom: 58px;
        left: ${taskInstagram.getBoundingClientRect().left}px;
        background: var(--windowBg);
        border: 1px solid var(--border);
        border-radius: 8px;
        box-shadow: 0 8px 24px rgba(0,0,0,.3);
        backdrop-filter: blur(20px);
        padding: 8px;
        min-width: 200px;
        z-index: 10000;
      `;
      
      menu.innerHTML = `
        <div style="padding: 8px 12px; font-size: 12px; opacity: 0.7; color: var(--text);">Instagram</div>
        <div style="height: 1px; background: var(--iconBorder); margin: 4px 0;"></div>
        <button class="ig-menu-item" data-url="${IG_GUMIS}" style="
          width: 100%;
          display: flex;
          align-items: center;
          gap: 10px;
          padding: 10px 12px;
          background: transparent;
          border: 0;
          border-radius: 6px;
          color: var(--text);
          cursor: pointer;
          font-size: 13px;
          text-align: left;
          transition: .12s ease;
        ">
          <img src="Instagram_icon.png" style="width: 18px; height: 18px; border-radius: 4px;" alt="">
          <div>
            <div style="font-weight: 600;">Gumis</div>
            <div style="font-size: 11px; opacity: 0.6;">@tokarz_k</div>
          </div>
        </button>
        <button class="ig-menu-item" data-url="${IG_GODWIFI}" style="
          width: 100%;
          display: flex;
          align-items: center;
          gap: 10px;
          padding: 10px 12px;
          background: transparent;
          border: 0;
          border-radius: 6px;
          color: var(--text);
          cursor: pointer;
          font-size: 13px;
          text-align: left;
          transition: .12s ease;
        ">
          <img src="Instagram_icon.png" style="width: 18px; height: 18px; border-radius: 4px;" alt="">
          <div>
            <div style="font-weight: 600;">god.wifi</div>
            <div style="font-size: 11px; opacity: 0.6;">@god.wifi</div>
          </div>
        </button>
      `;
      
      document.body.appendChild(menu);
      
      // Style hover effect
      const items = menu.querySelectorAll(".ig-menu-item");
      items.forEach(item => {
        item.addEventListener("mouseenter", () => {
          item.style.background = "var(--finderHoverBg)";
        });
        item.addEventListener("mouseleave", () => {
          item.style.background = "transparent";
        });
        item.addEventListener("click", () => {
          const url = item.getAttribute("data-url");
          window.open(url, "_blank", "noopener");
          closeIgTaskMenu();
        });
      });
      
      // Close on outside click
      setTimeout(() => {
        document.addEventListener("click", closeIgTaskMenu);
      }, 0);
      
    } else {
      closeIgTaskMenu();
    }
  });
  
  function closeIgTaskMenu() {
    const menu = document.getElementById("igTaskMenu");
    if (menu) {
      menu.remove();
    }
    igMenuOpen = false;
    document.removeEventListener("click", closeIgTaskMenu);
  }
  
  // Spotify - direct link
  taskSpotify.addEventListener("click", (e) => {
    e.stopPropagation();
    window.open(SPOTIFY_URL, "_blank", "noopener");
  });
  
  // Discord - direct link
  taskDiscord.addEventListener("click", (e) => {
    e.stopPropagation();
    window.open(DISCORD_URL, "_blank", "noopener");
  });

  // ===== Clock =====
  const clock = document.getElementById("clock");
  function tick(){
    const d = new Date();
    const hh = String(d.getHours()).padStart(2,"0");
    const mm = String(d.getMinutes()).padStart(2,"0");
    clock.textContent = `${hh}:${mm}`;
  }
  tick();
  setInterval(tick, 10000);

  // ===== Battery =====
  const batteryLevelEl = document.getElementById("batteryLevel");
  const batteryPctEl = document.getElementById("batteryPct");
  const batteryBoltEl = document.getElementById("batteryBolt");

  function batteryModelByHour(h){
    let pct = 100;
    let charging = false;

    // Charging: 22:00 (10 PM) to 08:00 (8 AM)
    // Discharging: 08:00 (8 AM) to 22:00 (10 PM)
    
    if (h >= 22 || h < 8){
      // Charging period
      charging = true;
      if (h >= 22) {
        // 22:00 - 23:59 (2 hours into night)
        const hoursCharging = h - 22;
        pct = Math.min(100, 20 + hoursCharging * 15);
      } else {
        // 00:00 - 07:59 (continuing charge)
        const hoursCharging = (24 - 22) + h; // hours since 22:00
        pct = Math.min(100, 20 + hoursCharging * 8);
      }
    } else {
      // Discharging period: 08:00 to 22:00 (14 hours total)
      charging = false;
      const hoursSinceStart = h - 8;
      // Start at 100%, end at ~12%
      pct = Math.round(100 - (hoursSinceStart / 14) * 88);
    }

    pct = Math.max(1, Math.min(100, pct));
    return { pct, charging };
  }

  function renderBattery(){
    const h = new Date().getHours();
    const { pct, charging } = batteryModelByHour(h);

    batteryLevelEl.style.width = pct + "%";
    batteryPctEl.textContent = pct + "%";
    
    // Show/hide charging bolt
    batteryBoltEl.style.opacity = charging ? "1" : "0";

    // Color based on percentage
    if (pct < 15) batteryLevelEl.style.background = "rgba(255,59,48,.9)";
    else if (pct < 35) batteryLevelEl.style.background = "rgba(255,149,0,.9)";
    else batteryLevelEl.style.background = "rgba(52,199,89,.9)";
  }
  renderBattery();
  setInterval(renderBattery, 30000);

  // ===== Window system =====
  const stage = document.getElementById("stage");
  const TASKBAR_SAFE = 48 + 10;

  let zCounter = 300;
  function bringToFront(win){
    zCounter += 1;
    win.style.zIndex = String(zCounter);
  }

  function resetToCenter(win){
    win.style.setProperty("--x", "0px");
    win.style.setProperty("--y", "0px");
  }

  function openWindow(win, fromEl){
    bringToFront(win);
    win.classList.add("open");
    resetToCenter(win);
  }

  function minimizeWindow(win, toEl, afterFn){
    if (!win.classList.contains("open")) return;
    win.classList.remove("open");
    resetToCenter(win);
    if (afterFn) afterFn();
  }

  function toggleWindow(win, fromEl, onClose){
    if (win.classList.contains("open")){
      minimizeWindow(win, fromEl, onClose);
    } else {
      openWindow(win, fromEl);
    }
  }

  function makeDraggable(titlebarEl){
    const id = titlebarEl.getAttribute("data-drag");
    const win = document.getElementById(id);

    let dragging = false;
    let startX = 0, startY = 0;
    let baseX = 0, baseY = 0;

    function getVarPx(name){
      const v = getComputedStyle(win).getPropertyValue(name).trim();
      return v ? parseFloat(v.replace("px","")) : 0;
    }
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    titlebarEl.addEventListener("pointerdown", (e)=>{
      if (!win.classList.contains("open")) return;
      if (e.target && e.target.classList && e.target.classList.contains("win-btn")) return;

      dragging = true;
      bringToFront(win);

      titlebarEl.setPointerCapture(e.pointerId);
      win.classList.add("dragging");

      startX = e.clientX;
      startY = e.clientY;
      baseX = getVarPx("--x");
      baseY = getVarPx("--y");
    });

    titlebarEl.addEventListener("pointermove", (e)=>{
      if (!dragging) return;

      const dx = e.clientX - startX;
      const dy = e.clientY - startY;

      // Get window dimensions
      const winRect = win.getBoundingClientRect();
      const winWidth = winRect.width;
      const winHeight = winRect.height;
      
      // Calculate max boundaries to keep titlebar visible
      // titlebar is ~48px high, so we need at least that much visible
      const titlebarHeight = 48;
      const minVisibleX = -(window.innerWidth / 2) + 100; // Keep at least 100px from left
      const maxVisibleX = (window.innerWidth / 2) - 100; // Keep at least 100px from right
      const minVisibleY = -(window.innerHeight / 2) + titlebarHeight; // Keep titlebar from going above screen
      const maxVisibleY = (window.innerHeight / 2) - titlebarHeight - 48; // Keep titlebar from going below taskbar (48px)

      let nx = clamp(baseX + dx, minVisibleX, maxVisibleX);
      let ny = clamp(baseY + dy, minVisibleY, maxVisibleY);

      win.style.setProperty("--x", nx + "px");
      win.style.setProperty("--y", ny + "px");
    });

    function stop(){
      dragging = false;
      win.classList.remove("dragging");
    }
    titlebarEl.addEventListener("pointerup", stop);
    titlebarEl.addEventListener("pointercancel", stop);

    win.addEventListener("pointerdown", ()=> bringToFront(win));
  }
  document.querySelectorAll(".titlebar[data-drag]").forEach(makeDraggable);

  // ===== Wire window controls =====
  function wireWindowControls(prefix, win, launcherEl, onClose){
    const closeBtn = document.getElementById(prefix+"Close");
    const minBtn = document.getElementById(prefix+"Min");
    const maxBtn = document.getElementById(prefix+"Max");

    let maxed = false;

    if (closeBtn) closeBtn.addEventListener("click", (e)=>{ e.stopPropagation(); minimizeWindow(win, launcherEl, onClose); });
    if (minBtn) minBtn.addEventListener("click", (e)=>{ e.stopPropagation(); minimizeWindow(win, launcherEl, onClose); });
    if (maxBtn) maxBtn.addEventListener("click", (e)=>{
      e.stopPropagation();
      if (!win.classList.contains("open")) return;
      maxed = !maxed;
      if (win.classList.contains("game")){
        win.style.width = maxed ? "min(940px, 96vw)" : "min(780px, 96vw)";
      } else if (win.classList.contains("finder")){
        win.style.width = maxed ? "min(940px, 94vw)" : "min(720px, 92vw)";
      } else if (win.classList.contains("notes")){
        win.style.width = maxed ? "min(980px, 96vw)" : "min(820px, 94vw)";
      } else {
        win.style.width = maxed ? "min(800px, 94vw)" : "min(600px, 90vw)";
      }
      resetToCenter(win);
    });
  }

  // ===== Windows =====
  const app = document.getElementById("app");
  const finderWin = document.getElementById("finderWin");
  const koncertWin = document.getElementById("koncertWin");
  const mixWin = document.getElementById("mixWin");
  const gameWin = document.getElementById("gameWin");
  const notesWin = document.getElementById("notesWin");
  const driveWin = document.getElementById("driveWin");
  const photosWin = document.getElementById("photosWin");
  const binWin = document.getElementById("binWin");
  const videoWin = document.getElementById("videoWin");

  const appLauncher = document.getElementById("appLauncher");
  const folderLauncher = document.getElementById("folderLauncher");
  const driveLauncher = document.getElementById("driveLauncher");
  const binLauncher = document.getElementById("binLauncher");
  const wifiBtn = document.getElementById("wifiBtn");
  const startBtn = document.getElementById("startBtn");

  const taskApp = document.getElementById("taskApp");
  const taskFinder = document.getElementById("taskFinder");
  const taskGame = document.getElementById("taskGame");

  wireWindowControls("app", app, appLauncher, ()=>{ setOpen(false); taskApp.style.display = "none"; });
  wireWindowControls("finder", finderWin, folderLauncher, ()=>{ taskFinder.style.display = "none"; });
  wireWindowControls("koncert", koncertWin, folderLauncher);
  wireWindowControls("mix", mixWin, folderLauncher, ()=> stopMix(true));
  wireWindowControls("game", gameWin, wifiBtn, ()=>{ taskGame.style.display = "none"; });
  wireWindowControls("notes", notesWin, folderLauncher);
  wireWindowControls("drive", driveWin, driveLauncher);
  wireWindowControls("photos", photosWin, driveLauncher);
  wireWindowControls("bin", binWin, binLauncher);
  wireWindowControls("video", videoWin, driveLauncher, ()=> stopVideo());

  // ===== Launchers =====
  const toggle = document.getElementById("toggle");
  const menuWrap = document.getElementById("menuWrap");
  const hint = document.getElementById("hint");

  function setOpen(open){
    menuWrap.classList.toggle("open", open);
    hint.textContent = open ? "Wybierz link" : "Kliknij logo, aby rozwinƒÖƒá";
  }

  toggle.addEventListener("click", ()=> setOpen(!menuWrap.classList.contains("open")));

  startBtn.addEventListener("click", ()=>{
    toggleWindow(app, startBtn, ()=>{ setOpen(false); taskApp.style.display = "none"; });
    if (app.classList.contains("open")){
      taskApp.style.display = "flex";
      taskApp.classList.add("active");
    }
  });

  appLauncher.addEventListener("click", ()=>{
    toggleWindow(app, appLauncher, ()=>{ setOpen(false); taskApp.style.display = "none"; });
    if (app.classList.contains("open")){
      taskApp.style.display = "flex";
      taskApp.classList.add("active");
    }
  });

  folderLauncher.addEventListener("click", ()=>{
    toggleWindow(finderWin, folderLauncher, ()=>{ taskFinder.style.display = "none"; });
    if (finderWin.classList.contains("open")){
      taskFinder.style.display = "flex";
      taskFinder.classList.add("active");
    }
  });

  driveLauncher.addEventListener("click", ()=>{
    // Show login modal instead of opening drive directly
    showLoginModal();
  });
  
  binLauncher.addEventListener("click", ()=>{
    toggleWindow(binWin, binLauncher);
  });

  // ===== Bin Photo Viewer =====
  const openBinPhoto = document.getElementById("openBinPhoto");
  
  openBinPhoto.addEventListener("click", ()=>{
    // Show photo login modal
    showPhotoLoginModal();
  });
  
  // ===== Photo Login Modal =====
  const photoLoginModal = document.getElementById("photoLoginModal");
  const photoLoginUsername = document.getElementById("photoLoginUsername");
  const photoLoginPassword = document.getElementById("photoLoginPassword");
  const photoLoginSubmit = document.getElementById("photoLoginSubmit");
  const photoLoginCancel = document.getElementById("photoLoginCancel");
  
  const PHOTO_LOGIN_TEXT = "Zanzir";
  
  function showPhotoLoginModal(){
    photoLoginModal.classList.add("open");
    photoLoginUsername.value = "";
    photoLoginPassword.value = "";
    
    // On mobile, make password field normal password input
    if (isMobileDevice) {
      photoLoginPassword.type = "password";
      photoLoginPassword.removeAttribute("readonly");
    }
    
    setTimeout(() => photoLoginUsername.focus(), 100);
  }
  
  function hidePhotoLoginModal(){
    photoLoginModal.classList.remove("open");
  }
  
  function attemptPhotoLogin(){
    // On mobile, accept any password length > 0
    const requiredPassLength = isMobileDevice ? 1 : 8;
    
    if (photoLoginUsername.value === PHOTO_LOGIN_TEXT && photoLoginPassword.value.length >= requiredPassLength) {
      hidePhotoLoginModal();
      
      // Open the photo viewer
      const viewer = document.getElementById("icloudViewer");
      const viewerImg = document.getElementById("icloudViewerImg");
      const viewerTitle = document.getElementById("icloudViewerTitle");
      
      viewerImg.src = "file_00000000b198722f8c3faf98fa197865.png";
      viewerTitle.textContent = "file_00000000b198722f8c3faf98fa197865.png";
      viewer.classList.add("open");
      viewer.setAttribute("aria-hidden", "false");
    } else {
      // Shake animation for incorrect login
      photoLoginModal.querySelector(".login-box").style.animation = "shake 0.3s";
      setTimeout(() => {
        photoLoginModal.querySelector(".login-box").style.animation = "";
      }, 300);
      
      // Show error message temporarily
      const errorMsg = document.createElement("div");
      errorMsg.style.cssText = `
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(255,59,48,.9);
        color: white;
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        z-index: 10001;
      `;
      errorMsg.textContent = "Nieprawid≈Çowy login lub has≈Ço!";
      photoLoginModal.querySelector(".login-box").appendChild(errorMsg);
      
      setTimeout(() => {
        errorMsg.remove();
      }, 2000);
    }
  }
  
  // Manual typing for username - no auto-fill
  photoLoginUsername.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      e.preventDefault();
      if (photoLoginUsername.value === PHOTO_LOGIN_TEXT) {
        photoLoginPassword.focus();
      } else {
        attemptPhotoLogin(); // Try to login (will fail and shake)
      }
    }
    if (e.key === "Escape") hidePhotoLoginModal();
  });
  
  // Password field behavior
  photoLoginPassword.addEventListener("keydown", (e) => {
    if (isMobileDevice) {
      // On mobile, allow normal typing
      if (e.key === "Enter") {
        e.preventDefault();
        attemptPhotoLogin();
      }
      if (e.key === "Escape") hidePhotoLoginModal();
      return;
    }
    
    // Desktop: bullet character behavior
    if (e.key.length === 1 && !e.ctrlKey && !e.metaKey) {
      e.preventDefault();
      
      if (photoLoginPassword.value.length < 8) {
        photoLoginPassword.value += "‚Ä¢";
        
        if (photoLoginPassword.value.length === 8) {
          setTimeout(() => attemptPhotoLogin(), 200);
        }
      }
    }
    
    if (e.key === "Backspace") {
      e.preventDefault();
      if (photoLoginPassword.value.length > 0) {
        photoLoginPassword.value = photoLoginPassword.value.slice(0, -1);
      }
    }
    
    if (e.key === "Enter") {
      e.preventDefault();
      attemptPhotoLogin();
    }
    if (e.key === "Escape") hidePhotoLoginModal();
  });
  
  photoLoginSubmit.addEventListener("click", attemptPhotoLogin);
  
  photoLoginCancel.addEventListener("click", hidePhotoLoginModal);
  
  // Close on background click
  photoLoginModal.addEventListener("click", (e) => {
    if (e.target === photoLoginModal) {
      hidePhotoLoginModal();
    }
  });

  // ===== Login Modal =====
  const loginModal = document.getElementById("loginModal");
  const loginUsername = document.getElementById("loginUsername");
  const loginPassword = document.getElementById("loginPassword");
  const loginSubmit = document.getElementById("loginSubmit");
  const loginCancel = document.getElementById("loginCancel");
  
  let loginKeysPressed = 0;
  const LOGIN_TEXT = "good_wifey";
  
  // Detect if mobile device
  const isMobileDevice = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent) || 
                         (navigator.maxTouchPoints > 0 && window.innerWidth < 768);
  
  function showLoginModal(){
    loginModal.classList.add("open");
    loginUsername.value = "";
    loginPassword.value = "";
    loginKeysPressed = 0;
    
    // On mobile, make password field normal input
    if (isMobileDevice) {
      loginPassword.type = "password";
      loginPassword.removeAttribute("readonly");
    }
    
    setTimeout(() => loginUsername.focus(), 100);
  }
  
  function hideLoginModal(){
    loginModal.classList.remove("open");
    loginKeysPressed = 0;
  }
  
  function attemptLogin(){
    // On mobile, accept any password length
    if (isMobileDevice) {
      if (loginUsername.value === LOGIN_TEXT && loginPassword.value.length > 0) {
        hideLoginModal();
        toggleWindow(driveWin, driveLauncher);
        return;
      }
    } else {
      // Desktop: check for exactly 8 characters
      if (loginUsername.value === LOGIN_TEXT && loginPassword.value.length === 8) {
        hideLoginModal();
        toggleWindow(driveWin, driveLauncher);
        return;
      }
    }
    
    // Shake animation for incorrect login
    loginModal.querySelector(".login-box").style.animation = "shake 0.3s";
    setTimeout(() => {
      loginModal.querySelector(".login-box").style.animation = "";
    }, 300);
  }
  
  // Auto-fill login field with "good_wifey" when typing (desktop only)
  loginUsername.addEventListener("keydown", (e) => {
    if (isMobileDevice) {
      // On mobile, allow normal typing
      if (e.key === "Enter") {
        e.preventDefault();
        loginPassword.focus();
      }
      if (e.key === "Escape") hideLoginModal();
      return;
    }
    
    // Desktop: auto-fill behavior
    if (e.key.length === 1 && !e.ctrlKey && !e.metaKey) {
      e.preventDefault();
      
      if (loginKeysPressed < LOGIN_TEXT.length) {
        loginUsername.value = LOGIN_TEXT.substring(0, loginKeysPressed + 1);
        loginKeysPressed++;
        
        if (loginKeysPressed === LOGIN_TEXT.length) {
          setTimeout(() => loginPassword.focus(), 100);
        }
      }
    }
    
    if (e.key === "Backspace") {
      e.preventDefault();
      if (loginKeysPressed > 0) {
        loginKeysPressed--;
        loginUsername.value = LOGIN_TEXT.substring(0, loginKeysPressed);
      }
    }
    
    if (e.key === "Enter" && loginUsername.value === LOGIN_TEXT) {
      loginPassword.focus();
    }
    if (e.key === "Escape") hideLoginModal();
  });
  
  // Password field behavior
  loginPassword.addEventListener("keydown", (e) => {
    if (isMobileDevice) {
      // On mobile, allow normal typing
      if (e.key === "Enter") {
        e.preventDefault();
        attemptLogin();
      }
      if (e.key === "Escape") hideLoginModal();
      return;
    }
    
    // Desktop: bullet character behavior
    if (e.key.length === 1 && !e.ctrlKey && !e.metaKey) {
      e.preventDefault();
      
      if (loginPassword.value.length < 8) {
        loginPassword.value += "‚Ä¢";
        
        if (loginPassword.value.length === 8) {
          setTimeout(() => attemptLogin(), 200);
        }
      }
    }
    
    if (e.key === "Backspace") {
      e.preventDefault();
      if (loginPassword.value.length > 0) {
        loginPassword.value = loginPassword.value.slice(0, -1);
      }
    }
    
    if (e.key === "Enter") attemptLogin();
    if (e.key === "Escape") hideLoginModal();
  });
  
  loginSubmit.addEventListener("click", attemptLogin);
  
  loginCancel.addEventListener("click", hideLoginModal);
  
  // Close on background click
  loginModal.addEventListener("click", (e) => {
    if (e.target === loginModal) {
      hideLoginModal();
    }
  });

  wifiBtn.addEventListener("click", ()=>{
    toggleWindow(gameWin, wifiBtn, ()=>{ taskGame.style.display = "none"; });
    if (gameWin.classList.contains("open")){
      taskGame.style.display = "flex";
      taskGame.classList.add("active");
      startOrResumeGame();
    }
  });

  taskApp.addEventListener("click", ()=> toggleWindow(app, appLauncher, ()=>{ setOpen(false); taskApp.style.display = "none"; }));
  taskFinder.addEventListener("click", ()=> toggleWindow(finderWin, folderLauncher, ()=>{ taskFinder.style.display = "none"; }));
  taskGame.addEventListener("click", ()=> toggleWindow(gameWin, wifiBtn, ()=>{ taskGame.style.display = "none"; }));

  const openKoncert = document.getElementById("openKoncert");
  const openMix = document.getElementById("openMix");
  const openSetlista = document.getElementById("openSetlista");
  const openIcloudPhotos = document.getElementById("openIcloudPhotos");

  openKoncert.addEventListener("click", ()=>{
    if (!finderWin.classList.contains("open")) openWindow(finderWin, folderLauncher);
    toggleWindow(koncertWin, folderLauncher);
  });

  openMix.addEventListener("click", ()=>{
    if (!finderWin.classList.contains("open")) openWindow(finderWin, folderLauncher);
    toggleWindow(mixWin, folderLauncher, ()=> stopMix(true));
  });

  openSetlista.addEventListener("click", ()=> toggleWindow(notesWin, openSetlista));

  openIcloudPhotos.addEventListener("click", ()=>{
    if (!driveWin.classList.contains("open")) openWindow(driveWin, driveLauncher);
    openWindow(photosWin, openIcloudPhotos);
    buildIcloudGrid();
  });

  const openArchive = document.getElementById("openArchive");
  openArchive.addEventListener("click", ()=>{
    if (!driveWin.classList.contains("open")) openWindow(driveWin, driveLauncher);
    toggleWindow(videoWin, openArchive);
  });

  // ===== MIX PLAYER =====
  const MIX_TRACKS = [
    { title: "Utw√≥r 1", src: "mix1.mp3" },
    { title: "Utw√≥r 2", src: "mix2.mp3" },
    { title: "Utw√≥r 3", src: "mix3.mp3" },
    { title: "Utw√≥r 4", src: "mix4.mp3" },
    { title: "Utw√≥r 5", src: "mix5.mp3" },
    { title: "Utw√≥r 6", src: "mix6.mp3" },
    { title: "Utw√≥r 7", src: "mix7.mp3" },
    { title: "Utw√≥r 8", src: "mix8.mp3" },
    { title: "Utw√≥r 9", src: "mix9.mp3" },
  ];

  const mixAudio = document.getElementById("mixAudio");
  const mixNowTitle = document.getElementById("mixNowTitle");
  const mixList = document.getElementById("mixList");
  const mixPlay = document.getElementById("mixPlay");
  const mixPrev = document.getElementById("mixPrev");
  const mixNext = document.getElementById("mixNext");
  const mixShuffleBtn = document.getElementById("mixShuffle");
  const mixRepeatBtn = document.getElementById("mixRepeat");
  const mixVol = document.getElementById("mixVol");
  const mixPbar = document.getElementById("mixPbar");
  const mixPfill = document.getElementById("mixPfill");
  const mixTcur = document.getElementById("mixTcur");
  const mixTend = document.getElementById("mixTend");

  let mixIndex = 0;
  let mixShuffle = false;
  let mixRepeat = false;
  let mixOrder = [...Array(MIX_TRACKS.length).keys()];

  function reshuffle(){
    mixOrder = [...Array(MIX_TRACKS.length).keys()];
    for (let i = mixOrder.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [mixOrder[i], mixOrder[j]] = [mixOrder[j], mixOrder[i]];
    }
    if (!mixOrder.includes(mixIndex)) mixOrder[0] = mixIndex;
  }

  function fmt(sec){
    const m = Math.floor(sec/60);
    const ss = String(Math.floor(sec%60)).padStart(2,"0");
    return `${m}:${ss}`;
  }

  function setMixButtons(){
    mixShuffleBtn.classList.toggle("on", mixShuffle);
    mixRepeatBtn.classList.toggle("on", mixRepeat);
    
    // Toggle playing class for play/pause icon
    if (mixAudio.paused) {
      mixPlay.classList.remove("playing");
    } else {
      mixPlay.classList.add("playing");
    }
  }

  function renderMixList(){
    mixList.innerHTML = "";
    MIX_TRACKS.forEach((t,i)=>{
      const row = document.createElement("div");
      row.className = "track" + (i===mixIndex ? " active":"");
      row.innerHTML = `
        <div class="left">
          <div class="name">${t.title}</div>
          <div class="sub">Full track</div>
        </div>
        <div class="right">${(i===mixIndex && !mixAudio.paused) ? "PLAYING" : ""}</div>
      `;
      row.addEventListener("click", ()=> loadMix(i, true));
      mixList.appendChild(row);
    });
  }

  function updateMixProgressUI(){
    const t = mixAudio.currentTime || 0;
    const duration = mixAudio.duration || 0;
    const pct = duration > 0 ? (t / duration) * 100 : 0;
    mixPfill.style.width = pct + "%";
    mixTcur.textContent = fmt(t);
    mixTend.textContent = fmt(duration);
  }

  function loadMix(i, autoplay=false){
    mixIndex = (i + MIX_TRACKS.length) % MIX_TRACKS.length;
    const t = MIX_TRACKS[mixIndex];
    mixNowTitle.textContent = t.title;
    mixAudio.src = t.src;
    mixAudio.currentTime = 0;
    renderMixList();
    setMixButtons();
    updateMixProgressUI();
    if (autoplay) playMix();
  }

  function playMix(){
    mixAudio.play();
    setMixButtons();
    renderMixList();
  }

  function pauseMix(){
    mixAudio.pause();
    setMixButtons();
    renderMixList();
  }

  function stopMix(reset=false){
    mixAudio.pause();
    if (reset){
      mixAudio.currentTime = 0;
      updateMixProgressUI();
    }
    setMixButtons();
    renderMixList();
  }

  function nextIndex(){
    if (!mixShuffle) return (mixIndex + 1) % MIX_TRACKS.length;
    const pos = mixOrder.indexOf(mixIndex);
    return mixOrder[(pos + 1) % mixOrder.length];
  }

  function prevIndex(){
    if (!mixShuffle) return (mixIndex - 1 + MIX_TRACKS.length) % MIX_TRACKS.length;
    const pos = mixOrder.indexOf(mixIndex);
    return mixOrder[(pos - 1 + mixOrder.length) % mixOrder.length];
  }

  mixPlay.addEventListener("click", ()=>{
    if (mixAudio.paused) playMix();
    else pauseMix();
  });
  mixNext.addEventListener("click", ()=> loadMix(nextIndex(), true));
  mixPrev.addEventListener("click", ()=> loadMix(prevIndex(), true));

  mixShuffleBtn.addEventListener("click", ()=>{
    mixShuffle = !mixShuffle;
    if (mixShuffle) reshuffle();
    setMixButtons();
  });

  mixRepeatBtn.addEventListener("click", ()=>{
    mixRepeat = !mixRepeat;
    setMixButtons();
  });

  mixVol.addEventListener("input", ()=>{
    const volume = Number(mixVol.value);
    mixAudio.volume = volume;
    
    // Update CSS variable for gradient fill
    const percent = volume * 100;
    mixVol.style.setProperty('--volume-percent', `${percent}%`);
  });
  
  // Initialize volume slider fill
  const initialPercent = Number(mixVol.value) * 100;
  mixVol.style.setProperty('--volume-percent', `${initialPercent}%`);

  mixPbar.addEventListener("click", (e)=>{
    const r = mixPbar.getBoundingClientRect();
    const x = Math.max(0, Math.min(r.width, e.clientX - r.left));
    const pct = x / r.width;
    const duration = mixAudio.duration || 0;
    mixAudio.currentTime = pct * duration;
    updateMixProgressUI();
  });

  // Auto-play next track when current track ends
  mixAudio.addEventListener("ended", ()=>{
    if (mixRepeat) loadMix(mixIndex, true);
    else loadMix(nextIndex(), true);
  });

  mixAudio.addEventListener("timeupdate", ()=>{
    updateMixProgressUI();
  });

  // Update duration display when metadata loads
  mixAudio.addEventListener("loadedmetadata", ()=>{
    updateMixProgressUI();
  });

  mixAudio.addEventListener("play", ()=>{ setMixButtons(); renderMixList(); });
  mixAudio.addEventListener("pause", ()=>{ setMixButtons(); renderMixList(); });

  function isMixOpen(){ return mixWin.classList.contains("open"); }

  window.addEventListener("keydown", (e)=>{
    if (!isMixOpen()) return;
    const tag = (document.activeElement && document.activeElement.tagName || "").toLowerCase();
    if (tag === "input" || tag === "textarea") return;

    const k = e.key.toLowerCase();

    if (e.code === "Space"){
      e.preventDefault();
      if (mixAudio.paused) playMix(); else pauseMix();
      return;
    }
    if (e.key === "ArrowRight"){
      e.preventDefault();
      loadMix(nextIndex(), true);
      return;
    }
    if (e.key === "ArrowLeft"){
      e.preventDefault();
      loadMix(prevIndex(), true);
      return;
    }
    if (k === "s"){
      mixShuffle = !mixShuffle;
      if (mixShuffle) reshuffle();
      setMixButtons();
      return;
    }
    if (k === "r"){
      mixRepeat = !mixRepeat;
      setMixButtons();
      return;
    }
  });

  mixAudio.volume = Number(mixVol.value);
  loadMix(0, false);

  // ===== VIDEO PLAYER =====
  const VIDEO_FILES = [
    { title: "BMX Video 1", src: "bmx1.mp4" },
    { title: "BMX Video 2", src: "bmx2.mp4" },
    { title: "BMX Video 3", src: "bmx3.mp4" },
    // bmx4.mp4 is missing - skip it
    { title: "BMX Video 5", src: "bmx5.mp4" },
    { title: "BMX Video 6", src: "bmx6.mp4" },
    { title: "BMX Video 7", src: "bmx7.mp4" },
  ];

  const videoPlayer = document.getElementById("videoPlayer");
  const videoNowTitle = document.getElementById("videoNowTitle");
  const videoList = document.getElementById("videoList");
  const videoPlay = document.getElementById("videoPlay");
  const videoPrev = document.getElementById("videoPrev");
  const videoNext = document.getElementById("videoNext");
  const videoVol = document.getElementById("videoVol");

  let videoIndex = 0;

  function renderVideoList(){
    videoList.innerHTML = "";
    VIDEO_FILES.forEach((v, i) => {
      const row = document.createElement("div");
      row.className = "track" + (i === videoIndex ? " active" : "");
      row.innerHTML = `
        <div class="left">
          <div class="name">${v.title}</div>
          <div class="sub">${v.src}</div>
        </div>
        <div class="right">${(i === videoIndex && !videoPlayer.paused) ? "PLAYING" : ""}</div>
      `;
      row.addEventListener("click", () => loadVideo(i, true));
      videoList.appendChild(row);
    });
  }

  function loadVideo(i, autoplay = false){
    videoIndex = (i + VIDEO_FILES.length) % VIDEO_FILES.length;
    const v = VIDEO_FILES[videoIndex];
    
    videoNowTitle.textContent = v.title;
    videoPlayer.src = v.src;
    videoPlayer.currentTime = 0;
    
    renderVideoList();
    updateVideoPlayButton();
    
    if (autoplay) playVideo();
  }

  function playVideo(){
    videoPlayer.play();
    updateVideoPlayButton();
    renderVideoList();
  }

  function pauseVideo(){
    videoPlayer.pause();
    updateVideoPlayButton();
    renderVideoList();
  }

  function stopVideo(){
    videoPlayer.pause();
    videoPlayer.currentTime = 0;
    updateVideoPlayButton();
    renderVideoList();
  }

  function updateVideoPlayButton(){
    if (videoPlayer.paused) {
      videoPlay.textContent = "‚ñ∂";
    } else {
      videoPlay.textContent = "‚è∏";
    }
  }

  function nextVideo(){
    loadVideo((videoIndex + 1) % VIDEO_FILES.length, true);
  }

  function prevVideo(){
    loadVideo((videoIndex - 1 + VIDEO_FILES.length) % VIDEO_FILES.length, true);
  }

  // Event listeners
  videoPlay.addEventListener("click", () => {
    if (videoPlayer.paused) playVideo();
    else pauseVideo();
  });

  videoNext.addEventListener("click", nextVideo);
  videoPrev.addEventListener("click", prevVideo);

  videoVol.addEventListener("input", () => {
    const volume = Number(videoVol.value);
    videoPlayer.volume = volume;
    const percent = volume * 100;
    videoVol.style.setProperty('--volume-percent', `${percent}%`);
  });

  // Initialize volume
  const initialVideoPercent = Number(videoVol.value) * 100;
  videoVol.style.setProperty('--volume-percent', `${initialVideoPercent}%`);

  // Auto-play next video when current ends
  videoPlayer.addEventListener("ended", nextVideo);

  // Update play button on play/pause
  videoPlayer.addEventListener("play", () => {
    updateVideoPlayButton();
    renderVideoList();
  });

  videoPlayer.addEventListener("pause", () => {
    updateVideoPlayButton();
    renderVideoList();
  });

  // Initialize video list
  videoPlayer.volume = Number(videoVol.value);
  loadVideo(0, false);

  // ===== Game =====
  const canvas = document.getElementById("dinoCanvas");
  const ctx = canvas.getContext("2d");
  const scoreEl = document.getElementById("score");
  const bestEl = document.getElementById("best");
  const stateEl = document.getElementById("gameState");

  let best = 0;
  let running = false;
  let dead = false;

  const G = 0.9;
  const groundY = 210;

  const player = { x: 90, y: groundY, w: 26, h: 34, vy: 0, onGround: true };
  let obstacles = [];
  let speed = 4.2;
  let score = 0;
  let spawnTimer = 0;

  function resetGame(){
    running = false;
    dead = false;
    speed = 4.3;
    score = 0;
    spawnTimer = 0;
    obstacles = [];
    player.y = groundY;
    player.vy = 0;
    player.onGround = true;
    scoreEl.textContent = "0";
    stateEl.textContent = "Kliknij / Space aby start";
  }

  function spawnObstacle(){
    const h = 18 + Math.random()*22;
    const w = 14 + Math.random()*20;
    obstacles.push({ x: canvas.width + 30, y: groundY + (34 - h), w, h });
  }

  function jump(){
    if (dead) { startOrResumeGame(true); return; }
    if (!running){ startOrResumeGame(true); return; }
    if (player.onGround){
      player.vy = -14.5;
      player.onGround = false;
    }
  }

  function collide(a,b){
    return (a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y);
  }

  function draw(){
    // Get theme colors from CSS variables
    const isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.globalAlpha = 0.9;
    ctx.beginPath();
    ctx.moveTo(0, groundY+34);
    ctx.lineTo(canvas.width, groundY+34);
    ctx.lineWidth = 2;
    ctx.strokeStyle = isDark ? "rgba(255,255,255,.3)" : "rgba(0,0,0,.25)";
    ctx.stroke();
    ctx.globalAlpha = 1;

    ctx.fillStyle = isDark ? "rgba(255,255,255,.92)" : "rgba(0,0,0,.85)";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    ctx.fillStyle = isDark ? "rgba(255,255,255,.6)" : "rgba(0,0,0,.6)";
    obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));

    ctx.globalAlpha = isDark ? 0.1 : 0.08;
    for (let i=0;i<4;i++){
      const cx = (i*260 + (score*2)%260);
      ctx.beginPath();
      ctx.ellipse(cx, 70 + i*8, 42, 18, 0, 0, Math.PI*2);
      ctx.fillStyle = isDark ? "rgba(255,255,255,1)" : "rgba(0,0,0,1)";
      ctx.fill();
    }
    ctx.globalAlpha = 1;
  }

  function step(){
    if (!running){
      draw();
      requestAnimationFrame(step);
      return;
    }

    player.vy += G;
    player.y += player.vy;

    if (player.y >= groundY){
      player.y = groundY;
      player.vy = 0;
      player.onGround = true;
    }

    spawnTimer -= 1;
    if (spawnTimer <= 0){
      spawnObstacle();
      spawnTimer = 55 + Math.random()*45;
    }

    obstacles.forEach(o => o.x -= speed);
    obstacles = obstacles.filter(o => o.x + o.w > -20);

    for (const o of obstacles){
      if (collide(player, o)){
        dead = true;
        running = false;
        stateEl.textContent = "Game over ‚Äî Space/klik aby zrestartowaƒá";
        best = Math.max(best, Math.floor(score));
        bestEl.textContent = String(best);
        break;
      }
    }

    score += 0.18;
    scoreEl.textContent = String(Math.floor(score));
    speed += 0.0022;

    draw();
    requestAnimationFrame(step);
  }

  function startOrResumeGame(forceRestart=false){
    if (forceRestart || dead){
      resetGame();
      dead = false;
    }
    if (!running){
      running = true;
      stateEl.textContent = "Grasz‚Ä¶";
    }
  }

  window.addEventListener("keydown", (e)=>{
    if (!gameWin.classList.contains("open")) return;
    if (e.code === "Space" || e.code === "ArrowUp"){
      e.preventDefault();
      jump();
    }
  });

  canvas.addEventListener("pointerdown", (e)=>{ 
    if (!gameWin.classList.contains("open")) return; 
    e.preventDefault(); 
    jump(); 
  });

  resetGame();
  requestAnimationFrame(step);

  // ===== iCloud Photos =====
  const REAL_PHOTOS = ["p1.jpg","p2.jpg","p3.jpg","p4.jpg","p5.jpg","p6.jpg"];
  const icloudGrid = document.getElementById("icloudGrid");
  const icloudViewer = document.getElementById("icloudViewer");
  const icloudViewerImg = document.getElementById("icloudViewerImg");
  const icloudViewerClose = document.getElementById("icloudViewerClose");
  const icloudViewerTitle = document.getElementById("icloudViewerTitle");
  const icloudSearch = document.getElementById("icloudSearch");
  const icloudTabs = Array.from(document.querySelectorAll(".icloudTab"));

  let currentFilter = "";

  function buildIcloudGrid(){
    if (!icloudGrid) return;
    icloudGrid.innerHTML = "";

    const totalTiles = 24;
    const realPhotosFiltered = REAL_PHOTOS.filter(n =>
      n.toLowerCase().includes(currentFilter.toLowerCase())
    );

    const realCount = Math.min(realPhotosFiltered.length, 10);
    const slots = new Set();
    while (slots.size < realCount){
      slots.add(Math.floor(Math.random() * totalTiles));
    }

    let idx = 0;

    for (let i=0; i<totalTiles; i++){
      const tile = document.createElement("div");
      tile.className = "photoTile";

      if (slots.has(i) && idx < realCount){
        const src = realPhotosFiltered[idx++];
        const img = document.createElement("img");
        img.src = src;
        img.alt = "";
        tile.appendChild(img);

        tile.addEventListener("click", ()=>{
          icloudViewerImg.src = src;
          icloudViewerTitle.textContent = src;
          icloudViewer.classList.add("open");
        });
      } else {
        tile.classList.add("loading");
      }

      icloudGrid.appendChild(tile);
    }
  }

  icloudViewerClose.addEventListener("click", ()=>{
    icloudViewer.classList.remove("open");
    icloudViewerImg.src = "";
  });

  window.addEventListener("keydown", (e)=>{
    if (e.key === "Escape" && icloudViewer.classList.contains("open")){
      icloudViewerClose.click();
    }
  });

  icloudSearch?.addEventListener("input", ()=>{
    currentFilter = icloudSearch.value || "";
    buildIcloudGrid();
  });

  icloudTabs.forEach(tab=>{
    tab.addEventListener("click", ()=>{
      icloudTabs.forEach(t=> t.classList.remove("active"));
      tab.classList.add("active");
      buildIcloudGrid();
    });
  });
</script>
</body>
</html>
